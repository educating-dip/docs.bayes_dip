Search.setIndex({"docnames": ["_apidoc/baselines", "_apidoc/baselines.evaluation_utils", "_apidoc/baselines.mcdo_dip_utils", "_apidoc/bayes_dip", "_apidoc/bayes_dip.data", "_apidoc/bayes_dip.data.datasets", "_apidoc/bayes_dip.data.datasets.mnist", "_apidoc/bayes_dip.data.datasets.rectangles", "_apidoc/bayes_dip.data.datasets.walnut", "_apidoc/bayes_dip.data.simulation", "_apidoc/bayes_dip.data.trafo", "_apidoc/bayes_dip.data.trafo.base_ray_trafo", "_apidoc/bayes_dip.data.trafo.matmul_ray_trafo", "_apidoc/bayes_dip.data.trafo.parallel_beam_2d_ray_trafo", "_apidoc/bayes_dip.data.trafo.walnut_2d_ray_trafo", "_apidoc/bayes_dip.data.utils", "_apidoc/bayes_dip.data.walnut_utils", "_apidoc/bayes_dip.dip", "_apidoc/bayes_dip.dip.deep_image_prior", "_apidoc/bayes_dip.dip.network", "_apidoc/bayes_dip.dip.network.unet", "_apidoc/bayes_dip.inference", "_apidoc/bayes_dip.inference.base_predictive_posterior", "_apidoc/bayes_dip.inference.exact_predictive_posterior", "_apidoc/bayes_dip.inference.sample_based_predictive_posterior", "_apidoc/bayes_dip.inference.utils", "_apidoc/bayes_dip.marginal_likelihood_optim", "_apidoc/bayes_dip.marginal_likelihood_optim.mll_optim", "_apidoc/bayes_dip.marginal_likelihood_optim.observation_cov_log_det_grad", "_apidoc/bayes_dip.marginal_likelihood_optim.preconditioner", "_apidoc/bayes_dip.marginal_likelihood_optim.preconditioner_utils", "_apidoc/bayes_dip.marginal_likelihood_optim.random_probes", "_apidoc/bayes_dip.marginal_likelihood_optim.sample_based_predcp", "_apidoc/bayes_dip.marginal_likelihood_optim.utils", "_apidoc/bayes_dip.marginal_likelihood_optim.weights_linearization", "_apidoc/bayes_dip.probabilistic_models", "_apidoc/bayes_dip.probabilistic_models.base_image_cov", "_apidoc/bayes_dip.probabilistic_models.base_observation_cov", "_apidoc/bayes_dip.probabilistic_models.image_noise_correction", "_apidoc/bayes_dip.probabilistic_models.isotropic", "_apidoc/bayes_dip.probabilistic_models.linear_sandwich_cov", "_apidoc/bayes_dip.probabilistic_models.linearized_dip", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.default_unet_priors", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.image_cov", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.low_rank_observation_cov", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.functorch_utils", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.getter", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.low_rank_neural_basis_expansion", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_cov", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_priors", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.utils", "_apidoc/bayes_dip.probabilistic_models.observation_cov", "_apidoc/bayes_dip.utils", "_apidoc/bayes_dip.utils.evaluation_utils", "_apidoc/bayes_dip.utils.experiment_utils", "_apidoc/bayes_dip.utils.linear_cg_gpytorch", "_apidoc/bayes_dip.utils.linear_cg_gpytorch_log_cg_re", "_apidoc/bayes_dip.utils.plot_utils", "_apidoc/bayes_dip.utils.test_utils", "_apidoc/bayes_dip.utils.tv", "_apidoc/bayes_dip.utils.utils", "index"], "filenames": ["_apidoc/baselines.rst", "_apidoc/baselines.evaluation_utils.rst", "_apidoc/baselines.mcdo_dip_utils.rst", "_apidoc/bayes_dip.rst", "_apidoc/bayes_dip.data.rst", "_apidoc/bayes_dip.data.datasets.rst", "_apidoc/bayes_dip.data.datasets.mnist.rst", "_apidoc/bayes_dip.data.datasets.rectangles.rst", "_apidoc/bayes_dip.data.datasets.walnut.rst", "_apidoc/bayes_dip.data.simulation.rst", "_apidoc/bayes_dip.data.trafo.rst", "_apidoc/bayes_dip.data.trafo.base_ray_trafo.rst", "_apidoc/bayes_dip.data.trafo.matmul_ray_trafo.rst", "_apidoc/bayes_dip.data.trafo.parallel_beam_2d_ray_trafo.rst", "_apidoc/bayes_dip.data.trafo.walnut_2d_ray_trafo.rst", "_apidoc/bayes_dip.data.utils.rst", "_apidoc/bayes_dip.data.walnut_utils.rst", "_apidoc/bayes_dip.dip.rst", "_apidoc/bayes_dip.dip.deep_image_prior.rst", "_apidoc/bayes_dip.dip.network.rst", "_apidoc/bayes_dip.dip.network.unet.rst", "_apidoc/bayes_dip.inference.rst", "_apidoc/bayes_dip.inference.base_predictive_posterior.rst", "_apidoc/bayes_dip.inference.exact_predictive_posterior.rst", "_apidoc/bayes_dip.inference.sample_based_predictive_posterior.rst", "_apidoc/bayes_dip.inference.utils.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.mll_optim.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.observation_cov_log_det_grad.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.preconditioner.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.preconditioner_utils.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.random_probes.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.sample_based_predcp.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.utils.rst", "_apidoc/bayes_dip.marginal_likelihood_optim.weights_linearization.rst", "_apidoc/bayes_dip.probabilistic_models.rst", "_apidoc/bayes_dip.probabilistic_models.base_image_cov.rst", "_apidoc/bayes_dip.probabilistic_models.base_observation_cov.rst", "_apidoc/bayes_dip.probabilistic_models.image_noise_correction.rst", "_apidoc/bayes_dip.probabilistic_models.isotropic.rst", "_apidoc/bayes_dip.probabilistic_models.linear_sandwich_cov.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.default_unet_priors.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.image_cov.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.low_rank_observation_cov.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.functorch_utils.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.getter.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.low_rank_neural_basis_expansion.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_cov.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_priors.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.rst", "_apidoc/bayes_dip.probabilistic_models.linearized_dip.utils.rst", "_apidoc/bayes_dip.probabilistic_models.observation_cov.rst", "_apidoc/bayes_dip.utils.rst", "_apidoc/bayes_dip.utils.evaluation_utils.rst", "_apidoc/bayes_dip.utils.experiment_utils.rst", "_apidoc/bayes_dip.utils.linear_cg_gpytorch.rst", "_apidoc/bayes_dip.utils.linear_cg_gpytorch_log_cg_re.rst", "_apidoc/bayes_dip.utils.plot_utils.rst", "_apidoc/bayes_dip.utils.test_utils.rst", "_apidoc/bayes_dip.utils.tv.rst", "_apidoc/bayes_dip.utils.utils.rst", "index.rst"], "titles": ["baselines package", "baselines.evaluation_utils module", "baselines.mcdo_dip_utils module", "bayes_dip package", "bayes_dip.data package", "bayes_dip.data.datasets package", "bayes_dip.data.datasets.mnist module", "bayes_dip.data.datasets.rectangles module", "bayes_dip.data.datasets.walnut module", "bayes_dip.data.simulation module", "bayes_dip.data.trafo package", "bayes_dip.data.trafo.base_ray_trafo module", "bayes_dip.data.trafo.matmul_ray_trafo module", "bayes_dip.data.trafo.parallel_beam_2d_ray_trafo module", "bayes_dip.data.trafo.walnut_2d_ray_trafo module", "bayes_dip.data.utils module", "bayes_dip.data.walnut_utils module", "bayes_dip.dip package", "bayes_dip.dip.deep_image_prior module", "bayes_dip.dip.network package", "bayes_dip.dip.network.unet module", "bayes_dip.inference package", "bayes_dip.inference.base_predictive_posterior module", "bayes_dip.inference.exact_predictive_posterior module", "bayes_dip.inference.sample_based_predictive_posterior module", "bayes_dip.inference.utils module", "bayes_dip.marginal_likelihood_optim package", "bayes_dip.marginal_likelihood_optim.mll_optim module", "bayes_dip.marginal_likelihood_optim.observation_cov_log_det_grad module", "bayes_dip.marginal_likelihood_optim.preconditioner module", "bayes_dip.marginal_likelihood_optim.preconditioner_utils module", "bayes_dip.marginal_likelihood_optim.random_probes module", "bayes_dip.marginal_likelihood_optim.sample_based_predcp module", "bayes_dip.marginal_likelihood_optim.utils module", "bayes_dip.marginal_likelihood_optim.weights_linearization module", "bayes_dip.probabilistic_models package", "bayes_dip.probabilistic_models.base_image_cov module", "bayes_dip.probabilistic_models.base_observation_cov module", "bayes_dip.probabilistic_models.image_noise_correction module", "bayes_dip.probabilistic_models.isotropic package", "bayes_dip.probabilistic_models.linear_sandwich_cov module", "bayes_dip.probabilistic_models.linearized_dip package", "bayes_dip.probabilistic_models.linearized_dip.default_unet_priors module", "bayes_dip.probabilistic_models.linearized_dip.image_cov module", "bayes_dip.probabilistic_models.linearized_dip.low_rank_observation_cov module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion package", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.functorch_utils module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.getter module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.low_rank_neural_basis_expansion module", "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion module", "bayes_dip.probabilistic_models.linearized_dip.parameter_cov module", "bayes_dip.probabilistic_models.linearized_dip.parameter_priors package", "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors module", "bayes_dip.probabilistic_models.linearized_dip.utils module", "bayes_dip.probabilistic_models.observation_cov module", "bayes_dip.utils package", "bayes_dip.utils.evaluation_utils module", "bayes_dip.utils.experiment_utils module", "bayes_dip.utils.linear_cg_gpytorch module", "bayes_dip.utils.linear_cg_gpytorch_log_cg_re module", "bayes_dip.utils.plot_utils module", "bayes_dip.utils.test_utils module", "bayes_dip.utils.tv module", "bayes_dip.utils.utils module", "Welcome to Bayes-DIP\u2019s documentation!"], "terms": {"evaluation_util": [0, 3, 57], "mcdo_dip_util": 0, "provid": [0, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 48, 49, 50, 51, 52, 53, 54, 55, 56, 64], "util": [0, 1, 2, 3, 4, 8, 21, 24, 26, 30, 35, 41, 47], "mc": 0, "dropout": [0, 2], "deep": [0, 17, 18], "imag": [0, 1, 5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 18, 20, 23, 24, 25, 27, 32, 36, 37, 38, 43, 44, 56, 58, 62, 63, 64, 65], "prior": [0, 17, 18, 22, 23, 26, 27, 32, 33, 41, 42, 43, 49, 52, 53, 58], "mcdo": [0, 1, 2], "dip": [0, 2, 3, 27, 32, 34, 41, 42, 55, 58], "compute_mcdo_reconstruct": 1, "run_path": [1, 58], "str": [1, 2, 6, 8, 9, 13, 14, 15, 18, 24, 27, 30, 31, 37, 42, 44, 49, 50, 52, 54, 56, 58, 59, 65], "sample_idx": [1, 58], "int": [1, 2, 7, 8, 9, 11, 12, 13, 14, 15, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 36, 37, 38, 43, 44, 46, 47, 48, 49, 50, 51, 52, 54, 55, 56, 58, 59, 63, 65], "devic": [1, 2, 9, 18, 24, 30, 31, 37, 44, 49, 50, 52, 54, 56, 58, 59], "none": [1, 2, 9, 12, 14, 16, 18, 22, 23, 24, 25, 27, 28, 29, 30, 31, 37, 40, 42, 43, 44, 46, 48, 49, 50, 51, 52, 54, 55, 56, 58, 59, 60, 61, 62, 63, 65], "experiment_path": [1, 58], "option": [1, 2, 6, 7, 8, 9, 12, 13, 14, 16, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 37, 38, 40, 42, 43, 44, 46, 48, 49, 50, 51, 52, 54, 56, 58, 59, 63, 65], "dict": [1, 15, 18, 23, 24, 25, 27, 28, 29, 32, 34, 40, 42, 43, 44, 48, 49, 52, 54, 56, 58], "float": [1, 2, 7, 8, 9, 18, 20, 22, 23, 24, 27, 28, 30, 32, 34, 37, 38, 44, 49, 54, 56, 58, 62, 65], "sourc": [1, 2, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 40, 42, 43, 44, 46, 47, 48, 49, 50, 51, 52, 54, 55, 56, 58, 59, 60, 61, 62, 63, 64, 65], "get_mcdo_density_data": 1, "tupl": [1, 7, 8, 9, 11, 12, 13, 15, 16, 24, 25, 28, 32, 34, 36, 37, 42, 43, 46, 47, 48, 49, 50, 51, 52, 54, 58, 59, 62, 63, 65], "bool": [1, 2, 6, 13, 18, 20, 24, 25, 27, 28, 29, 30, 32, 34, 43, 44, 48, 49, 50, 54, 56, 58, 59, 65], "return": [1, 2, 6, 8, 11, 12, 13, 14, 15, 16, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 40, 42, 43, 44, 46, 47, 48, 49, 50, 51, 52, 54, 55, 56, 58, 59, 60, 61, 62, 64, 65], "densiti": [1, 58], "data": [1, 3, 18, 30, 31, 34, 37, 44, 56, 58, 59, 62, 65], "sampl": [1, 2, 7, 8, 9, 13, 14, 15, 16, 20, 22, 23, 24, 27, 29, 30, 32, 36, 43, 44, 52, 54, 58, 59], "from": [1, 2, 7, 8, 9, 13, 14, 18, 20, 22, 23, 24, 25, 27, 29, 30, 36, 40, 43, 44, 47, 49, 50, 52, 54, 56, 58, 59, 61, 65], "sample_based_mcdo_predictive_posterior_": 1, "pt": [1, 58, 59], "get_mcdo_stddev": 1, "patch_idx_list": [1, 8, 24, 25, 58, 59], "union": [1, 9, 11, 12, 22, 24, 25, 32, 43, 44, 49, 52, 54, 58, 65], "list": [1, 8, 20, 24, 25, 42, 47, 52, 54, 55, 58, 59, 62, 65], "subtract_image_noise_correction_if_ani": [1, 58], "true": [1, 13, 16, 18, 20, 24, 25, 27, 28, 29, 30, 32, 34, 44, 49, 54, 56, 58, 59, 62, 65], "tensor": [1, 2, 8, 9, 11, 12, 13, 16, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 40, 43, 44, 46, 47, 48, 49, 50, 51, 52, 54, 56, 58, 59, 61, 64, 65], "standard": [1, 9, 34, 58], "deviat": [1, 9, 58], "i": [1, 6, 22, 23, 24, 25, 29, 32, 34, 36, 37, 40, 44, 46, 47, 49, 50, 52, 54, 58, 59, 64, 65], "e": [1, 6, 16, 22, 23, 24, 28, 29, 30, 32, 34, 36, 37, 40, 42, 44, 46, 47, 49, 50, 52, 54, 56, 58, 64, 65], "squar": [1, 8, 25, 30, 49, 58, 59, 65], "root": [1, 6, 30, 49, 58], "diagon": [1, 23, 24, 29, 30, 38, 54, 56, 58, 65], "covari": [1, 22, 23, 24, 27, 28, 29, 32, 33, 36, 37, 38, 40, 43, 44, 49, 52, 54, 56, 58], "paramet": [1, 2, 6, 8, 9, 11, 12, 13, 14, 15, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 40, 42, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 58, 59, 64, 65], "path": [1, 6, 8, 14, 16, 18, 27, 44, 50, 58, 59], "hydra": [1, 58, 59, 65], "run": [1, 16, 58, 59], "index": [1, 16, 58, 59, 65, 66], "patch": [1, 8, 24, 25, 58, 59], "indic": [1, 8, 24, 25, 47, 55, 56, 58, 59], "restrict": [1, 16, 52, 58, 59], "must": [1, 9, 14, 16, 20, 27, 28, 29, 32, 52, 56, 58, 59, 65], "subset": [1, 56, 58], "cfg": [1, 58, 59], "infer": [1, 3, 8, 27, 28, 58], "origin": [1, 6, 18, 30, 49, 58, 62, 65], "If": [1, 2, 9, 13, 14, 16, 18, 20, 24, 25, 27, 28, 29, 31, 34, 37, 44, 46, 48, 49, 50, 51, 52, 54, 56, 58, 59, 65], "string": [1, 58, 59, 62], "bayes_dip": [1, 2, 66], "experiment_util": [1, 3, 57, 58], "get_predefined_patch_idx_list": [1, 58, 59], "us": [1, 2, 6, 9, 12, 13, 14, 16, 18, 20, 24, 25, 27, 28, 29, 30, 32, 34, 36, 44, 46, 47, 49, 50, 51, 52, 54, 56, 58, 59, 62, 65], "default": [1, 2, 6, 7, 8, 9, 13, 14, 18, 20, 23, 24, 25, 27, 28, 29, 30, 32, 37, 42, 43, 44, 48, 49, 50, 52, 54, 56, 58, 59, 63, 65], "all": [1, 2, 13, 15, 16, 24, 25, 42, 46, 52, 54, 55, 58, 65], "ar": [1, 2, 7, 8, 9, 12, 13, 14, 15, 16, 18, 20, 24, 25, 27, 28, 29, 32, 34, 40, 42, 43, 44, 46, 47, 49, 52, 53, 54, 56, 58, 59, 65], "whether": [1, 6, 13, 16, 18, 20, 24, 25, 27, 28, 32, 34, 43, 44, 48, 49, 50, 56, 58, 59, 65], "subtract": [1, 58], "nois": [1, 9, 18, 22, 23, 24, 29, 37, 38, 44, 56, 58, 59, 60, 65], "correct": [1, 24, 38, 58], "term": [1, 18, 24, 27, 32, 34, 38, 44, 56, 58], "ani": [1, 9, 12, 16, 34, 42, 44, 54, 58, 64, 65], "befor": [1, 22, 23, 27, 28, 40, 49, 54, 58, 65], "take": [1, 16, 49, 54, 58], "The": [1, 2, 6, 7, 8, 9, 11, 12, 13, 14, 16, 18, 20, 23, 24, 25, 27, 28, 29, 30, 32, 34, 37, 40, 42, 43, 44, 46, 48, 49, 50, 52, 53, 54, 55, 56, 58, 59, 61, 62, 63, 65], "see": [1, 11, 12, 13, 18, 24, 27, 29, 34, 44, 49, 52, 54, 56, 58, 65], "translate_path": [1, 58], "stddev": [1, 58], "shape": [1, 7, 8, 9, 11, 12, 13, 15, 18, 20, 22, 23, 24, 25, 27, 29, 30, 31, 33, 34, 36, 37, 40, 43, 44, 46, 47, 48, 49, 50, 51, 52, 54, 56, 58, 59, 63, 64], "im_siz": [1, 58], "mont": 2, "carlo": 2, "approx_kernel_dens": 2, "ground_truth": [2, 8, 18, 22, 23, 24, 34, 58, 59, 65], "bw": 2, "0": [2, 7, 8, 13, 16, 18, 20, 24, 25, 27, 28, 29, 30, 31, 32, 33, 36, 37, 42, 44, 46, 49, 50, 52, 54, 56, 60, 61, 62, 65], "1": [2, 7, 8, 9, 13, 14, 15, 16, 18, 20, 22, 23, 24, 25, 27, 28, 30, 32, 34, 36, 37, 42, 43, 44, 46, 49, 50, 54, 56, 58, 59, 61, 64, 65], "noise_x_correction_term": [2, 22, 23, 24], "bayesianize_unet_architectur": 2, "nn_model": [2, 18, 34, 42, 46, 47, 48, 51, 52, 55, 58, 65], "unet": [2, 17, 19, 34, 42, 58], "p": [2, 44, 50, 61, 65], "05": [2, 7], "replac": [2, 24], "3x3": [2, 42], "nn": [2, 16, 20, 28, 32, 40, 43, 46, 47, 48, 51, 52, 54, 55], "conv2d": [2, 54], "layer": [2, 20, 42, 54, 65], "contain": [2, 8, 14, 25, 42, 58, 59], "an": [2, 8, 9, 11, 12, 13, 14, 16, 23, 24, 25, 29, 30, 32, 34, 36, 38, 44, 50, 52, 54, 60, 62, 65], "sequenti": 2, "wrap": [2, 16, 48, 49, 54, 65], "conv2d_dropout": 2, "network": [2, 3, 17, 18, 23, 27, 33, 34, 42, 46, 47, 48, 51, 52, 53, 54, 55, 58], "u": [2, 20, 42, 44, 50, 58], "net": [2, 20, 42, 58, 61], "model": [2, 18, 20, 27, 34, 35, 47, 58, 65], "other": [2, 16, 24, 44, 47, 65], "support": [2, 9, 30, 44, 51, 56, 58, 59], "rate": [2, 18, 27, 34], "class": [2, 6, 7, 9, 11, 12, 13, 16, 18, 20, 22, 23, 24, 29, 36, 37, 40, 43, 44, 45, 46, 49, 50, 51, 52, 54, 56, 65], "sub_modul": 2, "base": [2, 6, 7, 9, 11, 12, 13, 16, 18, 20, 21, 22, 23, 24, 29, 32, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56, 58, 65], "wrapper": [2, 6, 40, 49, 50, 65], "given": [2, 16, 22, 23, 24, 29, 33, 34, 54, 58, 65], "append": 2, "subsequ": 2, "method": [2, 9, 11, 12, 13, 16, 18, 20, 22, 23, 24, 28, 29, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56, 58, 60, 65], "__init__": [2, 6, 7, 9, 11, 12, 13, 16, 18, 20, 22, 23, 29, 37, 40, 43, 44, 46, 48, 49, 50, 51, 52, 54, 56, 65], "initi": [2, 16, 18, 20, 37, 42, 44, 52, 54, 56, 60], "intern": [2, 16, 20, 27], "state": [2, 16, 18, 20, 44, 46, 58, 61], "share": [2, 16, 20, 32, 54, 62], "both": [2, 9, 16, 20, 49, 51, 58], "scriptmodul": [2, 16, 20], "forward": [2, 11, 12, 13, 16, 20, 24, 36, 37, 40, 43, 44, 46, 48, 51, 52, 56, 65], "x": [2, 9, 11, 12, 13, 16, 20, 25, 54, 59, 61, 64, 65], "appli": [2, 9, 11, 12, 13, 16, 18, 20, 29, 30, 34, 40, 49, 54, 56, 65], "follow": [2, 16, 34, 65], "mc_dropout2d": 2, "5": [2, 24, 28, 31, 44, 50], "inplac": [2, 65], "fals": [2, 13, 16, 18, 20, 24, 25, 27, 28, 29, 34, 43, 44, 48, 49, 50, 54, 56, 58, 59, 61, 62, 65], "_dropoutnd": 2, "2d": [2, 11, 12, 13, 14, 25, 65], "inp": 2, "sample_from_bayesianized_model": 2, "filtbackproj": [2, 9, 18, 58, 59], "mc_sampl": [2, 24], "filter": [2, 11, 12, 13, 18, 54, 58], "back": [2, 11, 12, 13, 18, 44, 58], "project": [2, 8, 11, 12, 13, 14, 15, 16, 18, 38, 58], "number": [2, 7, 9, 13, 15, 16, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 36, 38, 44, 50, 52, 54, 56, 59, 60, 63, 65], "draw": [2, 43, 54], "torch": [2, 6, 9, 11, 12, 13, 16, 18, 20, 23, 24, 27, 28, 29, 30, 31, 32, 37, 44, 49, 50, 52, 54, 56, 58, 59, 65], "dataset": [3, 4, 9, 14, 16, 59], "submodul": 3, "trafo": [3, 4, 9, 15, 22, 23, 27, 34, 37, 38, 44, 48, 49, 56], "simul": [3, 4, 59], "walnut_util": [3, 4, 14], "deep_image_prior": [3, 17], "base_predictive_posterior": [3, 21], "exact_predictive_posterior": [3, 21], "sample_based_predictive_posterior": [3, 21], "marginal_likelihood_optim": 3, "mll_optim": [3, 26], "observation_cov_log_det_grad": [3, 26], "precondition": [3, 26, 27, 28, 30, 60, 61, 65], "preconditioner_util": [3, 26], "random_prob": [3, 26], "sample_based_predcp": [3, 26], "weights_linear": [3, 26, 27], "probabilistic_model": [3, 29, 32, 58], "isotrop": [3, 35, 42, 49, 54, 58], "linearized_dip": [3, 35, 58], "base_image_cov": [3, 35], "base_observation_cov": [3, 35], "image_noise_correct": [3, 35], "linear_sandwich_cov": [3, 35], "observation_cov": [3, 22, 23, 24, 27, 28, 29, 35, 38], "linear_cg_gpytorch": [3, 57, 65], "linear_cg_gpytorch_log_cg_r": [3, 57], "plot_util": [3, 57], "test_util": [3, 57], "tv": [3, 18, 27, 34, 57], "bay": 3, "mnist": [4, 5, 15, 59], "rectangl": [4, 5, 15], "walnut": [4, 5, 14, 15, 16], "base_ray_trafo": [4, 10], "matmul_ray_trafo": [4, 10], "parallel_beam_2d_ray_trafo": [4, 10], "walnut_2d_ray_trafo": [4, 10, 15], "gener": [4, 7, 9, 18, 31, 33, 49, 57, 58, 59, 63, 65], "access": [4, 5, 9], "rai": [4, 9, 10, 11, 12, 13, 14, 15, 16, 18, 34, 37, 38, 44, 48, 49, 56, 59], "transform": [4, 9, 10, 11, 12, 13, 14, 15, 16, 18, 34, 37, 38, 44, 48, 49, 56, 59], "synthet": 5, "store": [5, 6, 16, 46, 54, 65], "kmnist": [6, 15], "mnistimagedataset": 6, "dataset_typ": 6, "train": [6, 18, 59], "k": [6, 16, 27, 28, 59, 61], "callabl": [6, 9, 12, 29, 30, 42, 52, 54, 65], "either": [6, 16, 18, 44, 58, 59, 65], "torchvis": 6, "absolut": [6, 18, 56, 58, 64], "rel": [6, 9, 18, 56], "current": [6, 16, 18, 24, 27, 44, 59, 65], "work": [6, 18, 40, 59, 65], "directori": [6, 18, 58, 59, 65], "test": [6, 56, 57, 59, 63], "otherwis": [6, 18, 24, 27, 37, 44, 49, 50, 52, 56, 59], "get_kmnist_testset": 6, "get_kmnist_trainset": 6, "get_mnist_testset": 6, "get_mnist_trainset": 6, "rectanglesdataset": 7, "128": [7, 63], "num_rect": 7, "3": [7, 8, 11, 14, 20, 28, 42, 44, 59, 62, 63, 65], "num_angle_mod": 7, "angle_modes_sigma": 7, "length": [7, 8, 20, 25, 30, 54, 58, 59], "32000": 7, "fixed_se": 7, "smooth_sr_fact": 7, "8": 7, "iterabledataset": 7, "multipl": [7, 12, 37, 54, 60], "random": [7, 9, 18, 31, 44, 50], "normal": [7, 18, 29, 42, 54, 58, 65], "have": [7, 16, 20, 34, 65], "valu": [7, 8, 11, 12, 13, 14, 16, 18, 23, 24, 25, 27, 28, 30, 32, 37, 42, 44, 47, 49, 50, 52, 54, 56, 58, 62, 64, 65], "rang": 7, "background": 7, "each": [7, 9, 16, 18, 20, 24, 25, 27, 30, 31, 32, 34, 52, 54, 59, 62, 65], "ha": [7, 16, 20, 24, 32, 42, 43, 54, 58, 59, 64, 65], "2": [7, 8, 11, 13, 14, 16, 18, 20, 22, 23, 25, 42, 43, 46, 54, 56, 58, 63, 64], "overlai": 7, "addit": [7, 27, 36], "gaussian": [7, 24, 27, 28, 29, 32, 36, 43, 44, 52, 54, 61], "mode": [7, 16, 46, 48, 51, 56, 65], "which": [7, 8, 12, 16, 24, 27, 28, 47, 49, 58, 60, 65], "angl": [7, 8, 11, 12, 13, 14, 15], "can": [7, 16, 20, 22, 23, 24, 25, 38, 47, 49, 52, 53, 54, 62, 65], "For": [7, 11, 15, 47, 62], "one": [7, 11, 12, 13, 15, 16, 30, 54, 56, 58], "select": [7, 16, 30, 47, 58], "equal": 7, "probabl": [7, 22, 23, 24, 54, 58], "scale": [7, 8, 20, 24, 27, 32, 42, 49, 54], "fix": [7, 9, 59], "seed": [7, 9, 18, 59], "super": 7, "resolut": 7, "factor": [7, 8, 13, 14, 15, 16, 18, 24, 27, 29, 32, 34, 54, 56, 65], "A": [7, 14, 16, 18, 27, 28, 42, 44, 50, 54, 58, 61, 62, 65], "higher": 7, "lead": [7, 56, 64], "smoother": 7, "edg": [7, 16], "align": 7, "pixel": [7, 24, 25, 54, 58, 64], "grid": [7, 56], "ground": [8, 9, 18, 22, 23, 24, 34, 58, 59, 65], "truth": [8, 9, 18, 22, 23, 24, 34, 58, 59, 65], "get_walnut_2d_ground_truth": 8, "data_path": [8, 14, 16], "walnut_id": [8, 14, 16], "orbit_id": [8, 14, 16], "scaling_factor": 8, "14": 8, "slice": [8, 14, 16, 25, 46, 47, 55, 56, 65], "walnut1": [8, 14], "subfold": [8, 14, 58], "id": [8, 14, 61], "integ": [8, 14], "42": [8, 14], "orbit": [8, 14], "posit": [8, 14, 56, 60, 65], "multipli": [8, 11, 12, 13, 27, 29, 31, 36, 44, 50, 52, 54, 56], "default_walnut_scaling_factor": 8, "approxim": [8, 24, 28, 29, 30, 38, 44, 45, 50, 60, 65], "501": [8, 16], "get_walnut_2d_inner_part_defined_by_patch_s": 8, "patch_siz": [8, 24, 25, 58, 59], "pair": [8, 16], "specifi": [8, 9, 18, 20, 24, 25, 27, 31, 36, 46, 48, 51, 52, 56, 58, 59], "inner": [8, 40, 52, 62], "part": [8, 20, 27, 62], "depend": [8, 48], "minor": 8, "extent": 8, "sinc": [8, 16, 20], "defin": [8, 14, 16, 25, 42, 56, 58, 65], "get_image_patch_slic": [8, 25], "side": [8, 25, 30, 58, 59, 60, 65], "usual": [8, 22, 23, 25, 32, 34, 47, 56, 58, 59], "get_walnut_2d_inner_patch_indic": 8, "get_walnut_2d_observ": 8, "angular_sub_sampl": [8, 13, 14, 15, 16], "proj_col_sub_sampl": [8, 14, 16], "sub": [8, 13, 14, 15, 16, 18, 22, 27, 36, 47, 57, 58], "column": [8, 14, 60], "observ": [8, 9, 11, 12, 13, 18, 22, 23, 24, 27, 28, 29, 34, 37, 38, 44, 49, 56, 58, 59], "obs_numel": [8, 11, 12, 13], "where": [8, 9, 13, 23, 24, 27, 29, 34, 36, 37, 40, 43, 44, 46, 49, 50, 52, 54, 59, 65], "ceil": [8, 24, 59], "1200": 8, "768": 8, "white": [9, 62], "simulateddataset": 9, "image_dataset": 9, "sequenc": [9, 20, 32, 46, 47, 48, 51, 54, 55], "iter": [9, 18, 25, 27, 28, 34, 58, 60, 65], "ray_trafo": [9, 15, 18, 38, 59], "baseraytrafo": [9, 11, 12, 13, 15, 18, 34, 37, 44, 48, 49, 56, 59], "white_noise_rel_stddev": 9, "use_fixed_seeds_starting_from": [9, 59], "rng": 9, "ct": [9, 18], "item": [9, 65], "thi": [9, 11, 12, 13, 15, 16, 20, 24, 25, 27, 29, 30, 32, 36, 37, 38, 40, 44, 46, 48, 49, 50, 51, 52, 54, 56, 58, 59, 60, 64, 65], "noisy_observ": [9, 18, 59], "obs_shap": [9, 11, 12, 13, 18, 27, 34, 37, 44, 49, 56, 59], "label": [9, 59], "im_shap": [9, 11, 12, 13, 15, 18, 22, 23, 24, 25, 27, 34, 58, 59, 63], "fbp": [9, 11, 12, 13, 59], "__len__": 9, "__getitem__": 9, "directli": [9, 16, 30, 44, 65], "respect": [9, 24, 40, 43, 58, 59], "function": [9, 11, 12, 13, 16, 18, 24, 25, 27, 30, 32, 44, 48, 51, 54, 60, 65], "fail": 9, "thei": [9, 16, 65], "__iter__": 9, "simpli": 9, "over": [9, 42, 43, 49, 52, 53, 54, 64], "thu": 9, "onli": [9, 12, 24, 25, 32, 44, 49, 52, 56, 58, 59, 65], "stop": [9, 27, 28, 52, 60, 65], "when": [9, 12, 29, 60, 65], "exhaust": 9, "ad": [9, 23, 24, 54, 56, 59, 62, 65], "idx": 9, "custom": [9, 42, 52, 58, 65], "np": [9, 11, 12, 13, 22, 23, 24, 44, 46, 49, 50, 56, 58, 64], "advanc": [9, 18], "everi": [9, 16], "time": [9, 18, 27, 54, 58], "cannot": [9, 54], "combin": [9, 54], "new": [9, 29, 58], "default_rng": 9, "move": [9, 59], "includ": [9, 18, 20, 24, 25, 27, 34, 46, 48, 49, 51, 56, 57, 58, 59], "comput": [9, 12, 13, 16, 18, 22, 23, 24, 30, 32, 38, 44, 49, 50, 56, 58, 64, 65], "add": [9, 44, 56, 60, 62, 65], "mean": [9, 22, 23, 24, 27, 29, 32, 36, 38, 43, 44, 49, 52, 56, 58, 64], "ab": [9, 56], "pass": [9, 15, 16, 20, 23, 24, 27, 29, 30, 32, 34, 42, 44, 47, 48, 49, 52, 54, 56, 59, 65], "free": [9, 30], "abc": [11, 22, 29, 36, 37, 40, 46, 49, 54], "abstract": [11, 22, 24, 29, 36, 37, 40, 46, 49, 54], "attribut": [11, 12, 13, 16, 36, 37, 43, 46, 49, 51, 52, 54, 65], "geometri": [11, 12, 13], "im_0": [11, 12, 13], "im_1": [11, 12, 13], "3d": [11, 12, 13], "im_2": [11, 12, 13], "det_col": [11, 12, 13], "det_row": [11, 12, 13], "properti": [11, 12, 13, 36, 37, 43, 46, 49, 51, 52, 54], "ndarrai": [11, 12, 13, 25, 63, 65], "radian": [11, 12, 13], "batch": [11, 12, 13, 24, 25, 30, 37, 44, 46, 49, 50, 54, 56, 64], "channel": [11, 12, 13, 20, 54, 64], "attenu": [11, 12, 13], "trafo_adjoint": [11, 12, 13], "adjoint": [11, 12, 13, 16, 49], "oper": [11, 12, 13, 16, 29, 40, 46, 65], "sometim": [11, 12, 13], "implement": [11, 12, 13, 22, 23, 24, 28, 29, 30, 40, 44, 46, 49, 50, 51, 54, 56, 60, 65], "accur": [11, 12, 13], "match": [11, 12, 13, 20, 59], "discret": [11, 12, 13], "might": [11, 12, 13, 64], "consid": [11, 12, 13], "assembl": [11, 12, 13, 27, 46, 51, 56], "matrix": [11, 12, 13, 14, 22, 23, 24, 27, 28, 29, 30, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56, 58, 60, 65], "describ": [11, 12, 13, 27, 28, 30, 44, 50], "transpos": [11, 12, 13, 40], "result": [11, 12, 13, 16, 55, 60], "trafo_adjoint_flat": [11, 12, 13], "flat": [11, 12, 13, 44, 47], "version": [11, 12, 13, 32, 34, 44, 58], "1d": [11, 12, 13], "im_numel": [11, 12, 13], "trafo_flat": [11, 12, 13], "matmulraytrafo": [12, 13, 14, 38, 49, 56], "spmatrix": 12, "fbp_fun": 12, "arraylik": [12, 65], "spars": 12, "alwai": [12, 20, 24, 43, 55], "case": [12, 24], "arrai": [12, 16, 25, 58, 62], "like": [12, 20, 22, 27, 29, 47, 49, 54, 58], "scipi": 12, "numpi": [12, 16], "represent": [12, 13, 14, 29, 36, 37, 40, 43, 44, 47, 49, 52], "prod": [12, 13, 22, 23, 44, 46, 49, 50, 56, 58, 64], "parallelbeam2draytrafo": 13, "well": [13, 57], "getter": [13, 41, 42, 45], "its": [13, 22, 23, 28, 29, 44, 54, 58], "num_angl": [13, 15], "first_angle_zero": 13, "impl": 13, "astra_cuda": 13, "via": [13, 27, 28, 49, 51, 54, 56], "odl": 13, "slightli": 13, "inaccur": 13, "distribut": [13, 18, 23, 24, 29, 31, 32, 54, 58], "pi": 13, "shift": [13, 32], "first": [13, 16, 20, 52, 58, 59, 60, 65], "becom": 13, "half": 13, "step": [13, 27, 55, 65], "backend": 13, "tomo": 13, "raytransform": 13, "get_odl_ray_trafo_parallel_beam_2d": 13, "parallel": [13, 56], "beam": [13, 16], "get_odl_ray_trafo_parallel_beam_2d_matrix": 13, "flatten": [13, 25, 33, 40, 43, 44, 47, 54, 55], "document": [13, 58], "here": [13, 37], "dimens": [13, 16, 25, 37, 44, 50, 64], "get_parallel_beam_2d_matmul_ray_trafo": 13, "pseudo": [14, 38], "get_walnut_2d_ray_trafo": [14, 15], "matrix_path": 14, "singl": [14, 42, 49, 54, 58], "configur": [14, 62], "single_slice_config": 14, "request": 14, "folder": [14, 18, 27, 58], "mat": [14, 29, 44, 65], "file": [14, 18, 44, 50, 58, 59], "get_ray_trafo": 15, "name": [15, 24, 29, 52, 58, 59, 65], "kwarg": [15, 16, 23, 24, 29, 40, 43, 51, 52, 56, 62, 65], "set": [15, 18, 52, 59, 62], "keyword": [15, 18, 23, 24, 25, 27, 29, 34, 40, 43, 44, 49, 54, 56], "argument": [15, 16, 18, 23, 24, 25, 27, 29, 34, 36, 40, 43, 44, 49, 52, 54, 56, 65], "specif": [15, 49, 55], "dictionari": [15, 28, 32, 42, 52, 58], "To": 15, "disabl": 15, "those": 15, "being": [15, 28, 38, 65], "requir": [15, 16, 24, 27, 29, 34, 44, 48, 65], "interfac": [16, 49], "zenodo": 16, "arxiv": [16, 27, 28], "http": [16, 18, 27, 28, 29, 30, 44, 50, 61, 65], "github": [16, 29, 30, 61], "com": [16, 29, 30, 61], "cicwi": 16, "walnutreconstructioncod": 16, "featur": 16, "z": [16, 61, 65], "volum": 16, "h": [16, 36, 58, 64, 65], "der": 16, "sarkissian": 16, "f": [16, 59], "lucka": 16, "m": [16, 18, 30, 58], "van": 16, "eijnatten": 16, "g": [16, 24, 27, 28, 29, 42, 44, 49, 50, 54, 56, 58, 61, 65], "colacicco": 16, "s": [16, 24, 28, 40, 50, 58, 59, 64, 65], "b": [16, 61], "coban": 16, "j": [16, 18, 23, 27, 28, 30, 34, 44, 46, 49, 50, 54, 59, 61], "batenburg": 16, "2019": 16, "cone": 16, "tomographi": [16, 18], "collect": [16, 24], "design": [16, 24], "machin": 16, "learn": [16, 18, 27, 34], "scientif": 16, "doi": [16, 18, 30, 44, 50, 65], "org": [16, 18, 27, 28, 30, 44, 50, 65], "10": [16, 18, 30, 43, 44, 50, 52, 60, 61, 65], "1038": 16, "s41597": 16, "019": 16, "0235": 16, "y": [16, 30, 58, 65], "maskedwalnutraytrafo": 16, "proj_row_sub_sampl": 16, "first_proj_row": 16, "first_proj_col": 16, "num_proj_row": 16, "num_slic": 16, "rotat": 16, "shift_z": 16, "vol_mask_slic": 16, "proj_mask_select_k_row": 16, "proj_sub_sampling_via_geom": 16, "proj_up_sampling_via_geom": 16, "proj_up_sampling_kind_if_not_via_geom": 16, "linear": [16, 24, 27, 29, 34, 40, 41, 42, 55, 60, 65], "object": [16, 18, 25, 27, 43, 47, 52, 54, 55, 58, 62, 65], "mask": [16, 25, 58, 61], "apply_adjoint": 16, "apply_fdk": 16, "assert_proj_rows_suffic": 16, "assert_vol_slices_suffic": 16, "bp3d": 16, "build_proj_mask": 16, "fdk": 16, "fp3d": 16, "get_inds_in_flat_projs_per_angl": 16, "get_proj_slice_contributing_to_masked_vol": 16, "get_vol_slice_contributing_to_masked_proj": 16, "projs_from_flat_projs_in_mask": 16, "projs_from_ful": 16, "vol_from_ful": 16, "vol_from_vol_in_mask": 16, "vol_in_mask": 16, "padding_mod": 16, "flat_projs_in_mask": 16, "squeez": 16, "proj": 16, "proj_geom": 16, "proj_geom_no_sub_sampl": 16, "full_input": 16, "entri": [16, 24], "boolean": [16, 25, 65], "proj_mask": 16, "row": [16, 30, 56], "major": 16, "order": [16, 47, 52], "nb": 16, "It": [16, 25, 29, 42, 65], "would": [16, 25, 54], "meaning": 16, "reshap": 16, "multidimension": 16, "vol_x": 16, "vol_geom": 16, "out": [16, 34, 40], "projs_ful": 16, "vol_x_ful": 16, "numpyfunct": 16, "arg": [16, 51, 60, 65], "backward": [16, 65], "autograd": [16, 51, 65], "static": [16, 65], "ctx": [16, 65], "formula": [16, 65], "differenti": [16, 54, 65], "automat": [16, 56, 65], "alia": [16, 65], "vjp": [16, 43, 45, 46, 49, 50, 51, 56, 65], "overridden": [16, 29, 65], "subclass": [16, 65], "accept": [16, 65], "context": [16, 65], "mani": [16, 65], "output": [16, 18, 20, 34, 37, 40, 43, 44, 46, 48, 49, 50, 51, 54, 56, 58, 59, 65], "non": [16, 25, 44, 54, 65], "should": [16, 22, 23, 27, 28, 32, 34, 36, 40, 44, 46, 48, 49, 51, 56, 62, 65], "were": [16, 59, 65], "input": [16, 18, 20, 37, 40, 43, 46, 48, 49, 50, 51, 54, 56, 58, 64, 65], "gradient": [16, 27, 28, 29, 32, 44, 47, 60, 64, 65], "w": [16, 28, 36, 54, 61, 64, 65], "r": [16, 27, 28, 54, 61, 64, 65], "t": [16, 23, 28, 29, 36, 38, 40, 43, 44, 46, 49, 50, 52, 54, 64, 65], "correspond": [16, 55, 60, 65], "grad": [16, 28, 32, 47, 64, 65], "you": [16, 64, 65], "just": [16, 24, 30, 46, 65], "retriev": [16, 65], "save": [16, 18, 20, 27, 44, 50, 58, 59, 65], "dure": [16, 18, 65], "also": [16, 25, 27, 44, 49, 56, 58, 60, 61, 65], "needs_input_grad": [16, 65], "repres": [16, 23, 49, 65], "need": [16, 29, 30, 46, 56, 65], "forward_fun": [16, 65], "backward_fun": [16, 65], "perform": [16, 29, 37, 46, 48, 49, 50, 51, 56, 60, 65], "type": [16, 26, 27, 30, 31, 52, 54, 65], "arbitrari": [16, 58, 65], "though": [16, 65], "enforc": [16, 65], "compat": [16, 65], "instead": [16, 18, 20, 24, 27, 30, 34, 44, 49, 54, 56, 58, 59, 64, 65], "save_for_backward": [16, 65], "intend": [16, 65], "equival": [16, 29, 32, 65], "save_for_forward": [16, 65], "jvp": [16, 43, 45, 46, 49, 50, 51, 56, 65], "walnutraytrafo": 16, "vol_down_sampl": 16, "down": [16, 20, 42], "walnutraytrafomodul": 16, "walnut_ray_trafo": 16, "call": [16, 18, 29, 44, 46, 48, 51, 53, 58, 65], "although": 16, "recip": 16, "within": 16, "instanc": [16, 23, 28, 29, 30, 32, 33, 48, 50, 52, 54], "afterward": 16, "former": 16, "care": 16, "regist": 16, "hook": 16, "while": [16, 20], "latter": 16, "silent": 16, "ignor": [16, 28, 65], "them": [16, 42], "astra_bp3d_cuda": 16, "vol_x_out": 16, "astra_fdk_cuda": 16, "astra_fp3d_cuda": 16, "projs_out": 16, "down_sample_vol": 16, "down_sampl": 16, "kind": [16, 49, 58], "mean_pool": 16, "get_down_sampled_vol_shap": 16, "get_first_proj_col_for_sub_sampl": 16, "get_first_proj_row_for_sub_sampl": 16, "num_orig": 16, "972": 16, "num": 16, "get_ground_truth": [16, 58], "slice_ind": 16, "get_ground_truth_3d": 16, "get_masked_ray_trafo_matrix": 16, "file_path": 16, "get_proj_geom": 16, "return_vec": 16, "get_projection_data": 16, "get_single_slice_ind": 16, "get_single_slice_ray_trafo": 16, "get_single_slice_ray_trafo_matrix": 16, "get_single_slice_ray_trafo_matrix_filenam": 16, "get_vol_geom": 16, "save_masked_ray_trafo_matrix": 16, "save_single_slice_ray_trafo_matrix": 16, "output_path": 16, "sub_sample_proj": 16, "factor_row": 16, "first_row": 16, "num_row": 16, "factor_col": 16, "first_col": 16, "up_sample_proj": 16, "num_rows_orig": 16, "deepimagepriorreconstructor": [18, 32], "torch_manual_se": 18, "net_kwarg": 18, "load_params_path": 18, "reconstructor": 18, "regular": [18, 34], "wa": [18, 65], "introduc": [18, 61], "v": [18, 24, 28, 29, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56, 65], "lempitski": 18, "vedaldi": 18, "d": [18, 27, 28], "ulyanov": 18, "2018": [18, 27, 28], "ieee": [18, 65], "cvf": 18, "confer": [18, 61], "vision": 18, "pattern": 18, "recognit": 18, "1109": [18, 65], "cvpr": 18, "00984": 18, "otero": 18, "baguer": 18, "leuschner": 18, "schmidt": 18, "2020": 18, "reconstruct": [18, 24, 27, 32, 34, 58, 65], "invers": [18, 20, 29, 38, 44, 49, 54], "problem": 18, "1088": 18, "1361": 18, "6420": 18, "aba415": 18, "global": 18, "manual": [18, 20, 30, 64], "fork": 18, "cuda": [18, 24, 37, 44, 49, 50, 52, 56], "chosen": [18, 24, 32, 37, 44, 49, 50, 52, 56], "avail": [18, 24, 37, 44, 49, 50, 52, 56], "cpu": [18, 24, 37, 44, 49, 50, 52, 56, 59], "architectur": [18, 19, 20], "load": [18, 44, 50, 58, 59], "init_nn_model": 18, "load_param": 18, "params_path": 18, "recon_from_randn": 18, "use_tv_loss": 18, "log_path": [18, 27], "show_pbar": 18, "optim_kwarg": [18, 27, 32, 34], "noisi": 18, "self": [18, 20, 22, 23, 24, 29, 36, 37, 43, 44, 46, 49, 50, 51, 52, 54, 56], "print": [18, 24, 44, 49, 65], "log": [18, 22, 23, 24, 26, 27, 28, 54, 56, 58, 62], "psnr": [18, 62, 65], "std": 18, "dev": 18, "loss": [18, 32, 34, 64], "tensorboard": [18, 27, 58], "creat": [18, 27, 52], "start": [18, 27, 52, 56], "show": [18, 62], "progress": 18, "bar": 18, "optim": [18, 22, 23, 26, 27, 33, 34, 58], "gamma": [18, 27, 32, 34], "weight": [18, 27, 33, 34, 43, 47, 49, 54], "1e": [18, 23, 24, 28, 44, 49, 54, 56, 60, 61, 65], "4": [18, 20, 27, 28, 46, 48, 51, 62], "lr": [18, 27, 34], "10000": 18, "loss_funct": 18, "discrep": [18, 34], "mse": [18, 27], "best_output": 18, "minimum": [18, 27, 44, 49, 56, 59], "achiev": 18, "concat": 20, "concaten": [20, 33, 47, 54, 55], "crop": 20, "central": 20, "differ": [20, 24, 58, 64], "downblock": 20, "in_ch": 20, "out_ch": 20, "kernel_s": [20, 54], "num_group": 20, "use_norm": 20, "block": [20, 42], "two": 20, "convolut": [20, 42, 54], "obtain": [20, 64], "stride": 20, "kernel": [20, 54], "size": [20, 24, 25, 27, 29, 30, 31, 44, 49, 50, 54, 56, 58, 59, 60], "group": 20, "norm": [20, 24, 28, 42, 54, 60, 65], "after": [20, 27, 40, 60, 65], "inblock": 20, "outblock": 20, "skip_channel": 20, "use_sigmoid": [20, 34], "sigmoid_saturation_thresh": 20, "9": 20, "individu": [20, 25, 55], "skip": [20, 42, 50], "note": [20, 24, 32, 37, 44, 56, 58, 64], "unus": 20, "connect": [20, 42], "coarsest": 20, "sigmoid": [20, 34], "activ": [20, 34], "threshold": 20, "clamp": [20, 27, 49], "pre": 20, "saturation_safeti": 20, "effect": [20, 25], "x0": [20, 61], "return_pre_sigmoid": [20, 34], "control": [20, 28, 56, 65], "final": [20, 34, 52, 58], "mai": [20, 29, 58, 59], "numer": [20, 28, 30, 56, 65], "unstabl": 20, "user": [20, 44], "still": [20, 54], "unetreturnpresigmoid": [20, 34], "same": [20, 27, 29, 34, 36, 37, 40, 42, 43, 44, 47, 52, 54, 58, 64], "upblock": 20, "skip_ch": 20, "up": [20, 42, 56], "x1": 20, "x2": 20, "predict": [21, 22, 23, 24, 27], "posterior": [21, 22, 23, 24, 58], "basepredictiveposterior": [22, 23, 24], "baseobservationcov": [22, 23, 24, 29, 37, 44, 56], "hyperparamet": [22, 23, 26, 27, 32, 42, 52, 53, 54, 58], "cov": [22, 23, 24, 36, 37, 52, 54, 58], "log_prob": [22, 23, 24, 54, 58], "float64": [22, 23, 24], "under": [22, 23, 33, 52, 54], "amount": [22, 23, 24], "assum": [22, 23, 24, 32, 65], "present": [22, 23, 24], "help": [22, 23, 24, 49], "stabil": [22, 23, 24, 44, 54, 56], "num_sampl": [22, 23, 24, 25, 27, 29, 30, 32, 36, 43, 44, 52, 59], "exact": [23, 30, 45], "exactpredictiveposterior": 23, "matmulobservationcov": [23, 27, 56], "matmul": [23, 29, 30, 44, 46, 49, 51, 56, 65], "06": [23, 24, 44, 49, 54, 56, 65], "ep": [23, 44, 49, 54, 56, 60, 61], "6": [23, 24, 44, 49, 54, 56, 65], "parameter_cov": [23, 33, 35, 41, 43], "jacobian": [23, 27, 43, 46, 49, 50, 51, 56, 65], "image_cov": [23, 27, 32, 35, 37, 41, 44, 56, 58], "inner_cov": [23, 27, 32, 40, 43], "multivariate_normal_distribut": 23, "multivariatenorm": 23, "form": [23, 60], "dist": 23, "samplebasedpredictiveposterior": 24, "patch_kwarg": [24, 25], "unscal": [24, 54], "By": [24, 52], "wise": [24, 25], "varianc": [24, 27, 29, 37, 42, 44, 54, 56], "neglect": 24, "correl": 24, "between": [24, 27, 32, 44, 54, 58, 64], "how": [24, 25, 34], "split": [24, 25], "batch_siz": [24, 25, 29, 30, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56], "sum": [24, 32, 47, 49, 54, 64], "divid": [24, 49, 64], "total": 24, "log_prob_patch": 24, "reweight_off_diagonal_entri": 24, "verbos": [24, 30, 44, 49, 65], "return_patch_diag": 24, "sample_kwarg": 24, "precomput": 24, "zero": [24, 29, 36, 43, 44, 47, 52, 56, 60], "drawn": 24, "sample_zero_mean": 24, "samples_kwarg": 24, "doc": 24, "diag": [24, 38, 56], "inform": [24, 44, 46], "matric": [24, 54, 60], "patch_diag": 24, "cov_obs_mat_chol": 24, "use_conj_grad_inv": 24, "cg_kwarg": 24, "return_residual_norm_list": 24, "return_on_devic": 24, "contrast": 24, "doe": [24, 29, 34, 58], "choleski": [24, 29, 30, 54, 56, 65], "per": [24, 25, 42, 59], "cg": [24, 27, 28, 29, 60, 61, 65], "solv": [24, 29, 60, 65], "system": [24, 29, 60, 65], "residu": [24, 28, 29, 60, 61, 65], "affect": 24, "storag": 24, "n": [24, 25, 44, 50, 54, 62, 64], "residual_norm_list": 24, "scalar": [24, 54, 58], "solut": [24, 28, 60, 65], "yield_covariances_patch": 24, "yield": [24, 25], "batch_patch_ind": [24, 25], "batch_predictive_cov_image_patch": 24, "max": [24, 25, 60, 65], "batch_len_mask_ind": [24, 25], "except": [24, 25], "potenti": [24, 25], "shorter": 24, "last": [24, 25, 37, 44], "less": [24, 60], "than": [24, 54, 56, 60], "pad": [24, 25], "ident": 24, "ones": 24, "approx_predictive_cov_image_patch_from_zero_mean_samples_batch": 24, "estim": [24, 27, 28, 30, 32], "co": 24, "num_pixel": 24, "predictive_cov_image_patch_log_prob_unscaled_batch": 24, "recon_mask": 24, "ground_truth_mask": 24, "predictive_cov_image_patch": 24, "log_prob_unsc": 24, "predictive_cov_image_patch_norm": 24, "vector": [24, 29, 30, 31, 43, 46, 49, 50, 51, 54, 55, 56, 60, 65], "In": 25, "particular": 25, "evalu": [25, 29, 30, 36, 37, 40, 43, 44, 46, 49, 50, 52, 56, 58], "get_image_patch_mask_ind": 25, "image_shap": 25, "th": 25, "patch_mask_ind": 25, "divis": [25, 59, 60], "along": 25, "fit": 25, "enlarg": 25, "remain": 25, "reason": 25, "clip": 25, "maximum": [25, 27, 28, 49, 56, 60, 65], "min": [25, 65], "patch_slices_0": 25, "patch_slices_1": 25, "is_invalid": 25, "finit": 25, "batch_invalid_valu": 25, "yield_padded_batched_images_patch": 25, "return_patch_numel": 25, "denot": 25, "eff_batch_s": 25, "get": 25, "smaller": 25, "batch_samples_patch": 25, "These": 25, "remov": 25, "element": [25, 62], "margin": [26, 27, 33], "likelihood": [26, 27, 33], "mll": [26, 27, 58], "ii": [26, 27], "map": [26, 27, 34, 40], "routin": [27, 34], "marginal_likelihood_hyperparams_optim": 27, "observationcov": [27, 28, 29, 38, 56], "recon": [27, 58], "linearized_weight": 27, "comment": 27, "most": [27, 34, 52], "schedul": 27, "use_schedul": 27, "lr_schedul": 27, "steplr": 27, "step_siz": 27, "min_log_vari": 27, "logarithm": [27, 29], "num_prob": [27, 28, 31], "probe": [27, 28, 31], "determin": [27, 28, 46, 48, 51, 54], "isinst": [27, 49], "calcul": 27, "exactli": [27, 58], "linalg": [27, 54, 65], "slogdet": 27, "linear_cg": [27, 60, 65], "conjug": [27, 28, 29, 60, 65], "baseprecondition": [27, 28, 29], "left": [27, 28, 60, 65], "use_preconditioned_prob": [27, 28], "precondit": [27, 28, 29, 60, 65], "section": [27, 28], "gardner": [27, 28], "pleiss": [27, 28], "bindel": [27, 28], "q": [27, 28, 62], "weinberg": [27, 28], "wilson": [27, 28, 61], "gpytorch": [27, 28, 60, 65], "blackbox": [27, 28], "process": [27, 28, 61, 65], "gpu": [27, 28], "acceler": [27, 28], "pdf": [27, 28], "1809": [27, 28], "11165v6": [27, 28], "update_freq": 27, "updat": [27, 29, 44, 46, 49, 51, 60], "max_it": [27, 28, 30, 60, 61, 65], "rtol": [27, 65], "toler": [27, 28, 60, 61, 65], "earli": [27, 28, 65], "use_log_re_vari": [27, 28, 65], "low": [27, 28, 29, 44, 50, 61, 65], "precis": [27, 28, 61, 65], "arithmet": [27, 28, 61, 65], "variant": [27, 28, 61, 65], "maddox": [27, 28, 61, 65], "et": [27, 28, 44, 50, 65], "al": [27, 28, 44, 50, 65], "linear_log_cg_r": [27, 28, 61, 65], "include_predcp": 27, "complex": 27, "predcp": [27, 32], "use_map_weights_mean": 27, "map_weight": [27, 34], "compar": 27, "numel": [27, 47], "becaus": 27, "sse": 27, "suffix": 27, "approx_observation_cov_log_det_grad": 28, "precon": 28, "max_cg_it": 28, "50": 28, "cg_rtol": 28, "001": [28, 30], "ignore_numerical_warn": [28, 65], "hutchinson": 28, "trace": 28, "param": 28, "Not": [28, 29, 65], "yet": [28, 65], "warn": [28, 49, 59, 65], "kei": [28, 32, 42, 52, 54, 58, 65], "residual_norm": [28, 65], "update_kwarg": [29, 44], "commonli": 29, "improv": [29, 49], "condit": [29, 49], "closur": [29, 30, 37, 45, 49, 56, 65], "get_closur": [29, 37], "use_invers": [29, 44, 54], "receiv": [29, 30, 54], "product": [29, 30, 36, 37, 40, 43, 44, 46, 49, 50, 51, 52, 54, 56, 65], "adapt": [29, 65], "incompletecholeskyprecondition": 29, "incomplete_choleski": 29, "log_noise_vari": 29, "incomplet": 29, "ichol": 29, "ey": 29, "cornelliu": [29, 30], "gp": [29, 30, 32, 42], "linear_oper": [29, 30], "blob": [29, 30, 61], "987df55260afea79eb0590c7e546b221cfec3fe5": 29, "added_diag_linear_oper": 29, "py": [29, 30, 58, 61], "l84": 29, "low_rank_rank_dim": [29, 44, 50], "cf": 29, "jacobiprecondition": 29, "jacobi": 29, "lowrankobservationcovprecondition": 29, "low_rank_observation_cov": [29, 35, 41], "lowrankobservationcov": [29, 44], "default_update_kwarg": 29, "emploi": [29, 49], "rank": [29, 44, 50], "expect": [29, 52, 58], "alreadi": [29, 65], "constructor": [29, 52], "enhanc": 29, "overrid": 29, "get_precondition": 29, "low_rank_eig": 29, "further": 29, "oversampling_param": [29, 44, 50], "incomplete_chol": 29, "approx_diag_num_sampl": [29, 30], "approx_diag": 30, "dtype": [30, 31, 54], "figur": 30, "c": [30, 65], "beka": 30, "kokiopoul": 30, "saad": 30, "2007": 30, "mathemat": 30, "1016": 30, "apnum": 30, "01": 30, "003": 30, "estimated_diag": 30, "pivoted_choleski": 30, "100": [30, 32, 38, 44], "error_tol": 30, "recompute_max_diag_valu": 30, "matrix_diag": 30, "simplifi": [30, 34], "clone": [30, 60, 61, 65], "pivot": 30, "decomposit": [30, 44, 50], "main": 30, "_pivoted_choleski": 30, "chang": 30, "made": 30, "linearoper": 30, "do": 30, "dim": [30, 61], "we": [30, 37], "popul": [30, 58], "l": [30, 44], "anywai": 30, "generate_probes_bernoulli": 31, "side_length": 31, "jacobi_vector": 31, "bernoulli": 31, "pow": 31, "probe_vector": 31, "sample_based_predcp_grad": 32, "baseimagecov": [32, 36, 37, 43, 44, 56], "prior_list_under_predcp": 32, "gpprior": [32, 54], "image_mean": 32, "return_shifted_loss": 32, "distinct": 32, "space": [32, 36, 37, 38, 40, 43, 44, 49, 52, 56], "parametercov": [32, 33, 43, 52], "whose": 32, "log_lengthscal": [32, 54], "log_vari": [32, 52, 54], "proport": 32, "total_shifted_loss": 32, "get_ordered_nn_params_vec": 33, "ordered_nn_params_vec": 33, "neural_basis_expans": [34, 35, 41, 43], "baseneuralbasisexpans": [34, 43, 46, 47, 48, 49, 50, 51], "neural": [34, 45, 46, 48, 49, 50, 51, 54], "basi": [34, 44, 45, 46, 48, 49, 50, 51], "expans": [34, 45, 46, 48, 49, 50, 51], "instruct": 34, "handl": 34, "keep": 34, "exclud": [34, 54, 65], "full": [34, 47, 56, 58], "jac_shap": [34, 46, 49, 51], "simplified_eqn": 34, "lin_weight": 34, "pre_sigmoid_recon": 34, "noise_precis": 34, "wd": 34, "decai": 34, "lin_recon": 34, "parameter_prior": [35, 41], "default_unet_prior": [35, 41], "probabilist": [35, 44, 50], "theoret": [36, 37, 43, 52], "view": [36, 40, 43, 44, 46, 49, 50], "unless": 36, "init_noise_vari": [37, 44, 56], "get_image_noise_correction_term": 38, "pinv": 38, "noise_vari": 38, "interpret": 38, "image_noise_correction_term": 38, "get_trafo_t_trafo_pseudo_inv_diag_mean": 38, "n_eigenvec": 38, "truncat": 38, "svd": [38, 50], "eigenvector": [38, 44], "diag_mean": 38, "linearsandwichcov": [40, 43], "sandwich": 40, "lin_op": [40, 43], "lin_op_transpos": [40, 43], "base_neural_basis_expans": [41, 45], "functorch_util": [41, 45], "gprior_neural_basis_expans": [41, 45], "low_rank_neural_basis_expans": [41, 45], "assign": [42, 52], "get_default_unet_gaussian_prior_dict": 42, "gaussian_prior_hyperparams_init": 42, "normal_prior_hyperparams_init": 42, "One": [42, 44], "place": [42, 47, 53, 54, 62, 65], "1x1": 42, "lengthscal": [42, 54], "prior_assignment_dict": [42, 52], "without": [42, 44, 49], "inc": 42, "get_gpprior_radialbasisfunccov": [42, 54], "conv": 42, "down_0": 42, "down_1": 42, "up_0": 42, "up_1": 42, "outc": 42, "normalprior": [42, 54], "hyperparams_init_dict": [42, 52], "fill": 42, "get_default_unet_gprior_dict": 42, "gprior_hyperparams_init": 42, "gprior": 42, "isotropicprior": [42, 54], "imagecov": [43, 58], "num_param": [43, 46, 49, 50, 51, 52], "nn_out_shap": [43, 46, 48, 49, 50, 51], "return_weight_sampl": 43, "sample_only_from_prior": [43, 52], "weight_sampl": 43, "load_state_dict": 44, "load_approx_basi": 44, "requires_grad": 44, "algorithm": [44, 50], "halko": [44, 50], "martinsson": [44, 50], "tropp": [44, 50], "2011": [44, 50], "find": [44, 50], "structur": [44, 50, 65], "construct": [44, 50], "siam": [44, 50], "review": [44, 50], "1137": [44, 50], "090771806": [44, 50], "oversampl": [44, 50], "respons": 44, "consist": 44, "enabl": 44, "so": [44, 64, 65], "propag": 44, "repeatedli": 44, "retain_graph": 44, "get_low_rank_observation_cov_basi": 44, "use_cpu": [44, 50], "eigenvalu": 44, "algo": [44, 50], "qr": [44, 50], "filepath_or_dict": 44, "second": [44, 65], "save_approx_basi": 44, "filepath": [44, 50, 58], "full_diag_ep": 44, "variabl": 44, "involv": 44, "minumum": 44, "allow": 45, "basematmulneuralbasisexpans": [46, 48, 49, 51], "nn_input": [46, 48, 51], "ordered_nn_param": [46, 48, 51, 52, 55], "partial": 46, "get_matrix": [46, 49, 51, 56], "update_matrix": [46, 49, 51], "sub_slic": 46, "expos": 46, "eval": [46, 48, 51, 65], "functorch": [47, 51], "flatten_grad_functorch": 47, "inds_from_ordered_param": 47, "flat_grad": 47, "total_selected_num_param": 47, "ind": 47, "unflatten_nn_functorch": 47, "slices_from_ordered_param": 47, "unpack": 47, "weights_tupl": 47, "insert": [47, 65], "creator": 48, "get_matmul_neural_basis_expans": 48, "use_gprior": [48, 58], "scale_kwarg": [48, 49], "matmulneuralbasisexpans": [48, 51, 56, 58], "matmulgpriorneuralbasisexpans": [48, 49], "iff": [48, 49], "get_neural_basis_expans": 48, "neuralbasisexpans": [48, 50, 51, 58], "gpriorneuralbasisexpans": [48, 49], "mixingpriorneuralbasisexpans": 49, "similar": [49, 65], "compute_scal": 49, "recomput": [49, 58], "update_scal": 49, "more": [49, 54, 56, 59], "return_scal": 49, "mixin": 49, "reduct": 49, "max_scale_thresh": 49, "100000": 49, "use_single_batch": 49, "surrog": 49, "accumul": 49, "exceed": 49, "rais": [49, 58, 59], "1e5": 49, "scale_vec": 49, "lowrankneuralbasisexpans": 50, "load_from_fil": 50, "get_low_rank_jac_basi": 50, "direct": [50, 64], "singular": 50, "orthonorm": 50, "vh": 50, "functional_forward_kwarg": 51, "basegaussprior": [52, 54], "module_nam": 52, "init_hyperparam": [52, 54], "only_prior": 52, "params_slic": 52, "params_slices_per_prior": 52, "outer": 52, "occur": 52, "get_params_under_prior": [52, 54], "itself": [53, 54, 58, 65], "effici": 54, "batched_cov_mul": 54, "As": 54, "convent": 54, "actual": 54, "classmethod": [54, 56], "use_choleski": [54, 56], "cov_mat_kwarg": 54, "stack": 54, "repeat": [54, 56], "num_total_filt": 54, "cov_mat": 54, "v_cov_mul": 54, "cov_log_det": 54, "get_params_under_prior_from_modul": 54, "wai": 54, "rsampl": 54, "covariance_constructor": 54, "init_paramet": 54, "log_det": 54, "log_lengthscale_cov_mat_grad": 54, "log_variance_cov_mat_grad": 54, "radialbasisfunccov": 54, "exampl": 54, "cov_log_lengthscale_grad": 54, "deriv": 54, "cov_log_variance_grad": 54, "return_choleski": 54, "dist_func": 54, "distanc": 54, "coordin": 54, "coords0": 54, "coords1": 54, "exp": 54, "as_tensor": 54, "float32": 54, "cov_mat_or_chol": 54, "lengthscale_init": 54, "variance_init": 54, "unscaled_cov_mat": 54, "euclidean": 54, "lambda": 54, "ord": 54, "get_inds_from_ordered_param": 55, "inds_in_full_model": 55, "get_slices_from_ordered_param": 55, "apply_make_cholesk": 56, "explicit": 56, "stabl": 56, "assemble_observation_cov": 56, "use_noise_vari": 56, "sub_slice_batch": 56, "themselv": 56, "analog": 56, "get_stabilizing_ep": 56, "observation_cov_mat": 56, "eps_mod": 56, "eps_min_for_auto": 56, "include_zero_for_auto": 56, "epsilon": 56, "rel_mean_diag": 56, "auto_ab": 56, "much": 56, "least": 56, "auto_rel_mean_diag": 56, "point": 56, "variou": 57, "experi": [57, 58, 59], "script": [57, 62], "multirun": 58, "compute_log_prob_for_patch_size_from_cov": 58, "exact_dens": 58, "extract_tensorboard_scalar": 58, "log_fil": 58, "save_as_npz": 58, "tag": 58, "extract": 58, "npz": 58, "find_single_log_fil": 58, "log_dir": 58, "found": 58, "recurs": 58, "prefix": [58, 59], "get_abs_diff": 58, "abs_diff": 58, "get_density_data": 58, "sample_based_dens": 58, "exact_predictive_posterior_": 58, "sample_based_predictive_posterior_": 58, "is_exact": 58, "neither": 58, "runtimeerror": 58, "get_image_cov": 58, "use_matmul_neural_basis_expans": 58, "reinstanti": 58, "dip_mll_optim": 58, "exact_dip_mll_optim": 58, "get_nn_model": 58, "get_observ": 58, "get_patch_idx_to_mask_inds_dict": 58, "get_recon": 58, "get_sample_based_cov_diag": 58, "nan": 58, "cov_diag": 58, "get_stddev": 58, "is_single_level_date_time_path": 58, "check": 58, "date": 58, "encod": 58, "our": 58, "config": [58, 59], "dir": 58, "now": 58, "dt": 58, "fz": 58, "sweep": 58, "oppos": 58, "insid": 58, "recompute_reconstruct": 58, "restrict_sample_based_density_data_to_new_patch_idx_list": 58, "orig_patch_idx_list": 58, "data_restrict": 58, "translate_multirun_path": 58, "multirun_path": 58, "translat": 58, "translate_output_path": 58, "outputs_path": 58, "default_outputs_path": 58, "default_multirun_path": 58, "assert_sample_match": 59, "data_sampl": 59, "raise_if_file_not_found": 59, "assert": [59, 65], "previou": 59, "filenotfounderror": 59, "predefin": 59, "get_standard_dataset": 59, "dictconfig": 59, "fold": 59, "valid": 59, "1000000": 59, "get_standard_ray_trafo": 59, "load_sampl": 59, "restrict_to_num_sampl": 59, "map_loc": 59, "save_sampl": 59, "chunk": 59, "due": 59, "filenam": 59, "eff_num_sampl": 59, "chunk_siz": 59, "samples_": 59, "_chunk_": 59, "matmul_closur": [60, 61], "rh": [60, 61], "n_tridiag": 60, "stop_updating_aft": [60, 61], "max_tridiag_it": [60, 61], "initial_guess": [60, 61], "lh": 60, "definit": 60, "symmetr": 60, "lhs_mat": 60, "right": [60, 65], "hand": [60, 65], "equat": 60, "tridiagon": 60, "prevent": 60, "reach": 60, "guess": 60, "precondition_closur": 60, "suppli": 60, "tridiag": 60, "andpotap": 61, "halfpres_gp": 61, "6aead66d9d9efc30b5e3ee3a49697d660a8c4043": 61, "core": 61, "gpytorch_log_cg_r": 61, "re": 61, "orthogon": 61, "potapczynski": 61, "2022": 61, "fast": 61, "38th": 61, "uncertainti": 61, "artifici": 61, "intellig": 61, "openreview": 61, "forum": 61, "s3nox_ij9xc": 61, "compute_robust_denom_unclip": 61, "ap": 61, "cond_fun": 61, "initialize_log_r": 61, "logsumexp": 61, "return_sign": 61, "min_val": 61, "45": 61, "re_orthogon": 61, "u_al": 61, "take_cg_step_log_r": 61, "update_alpha_log_unclip": 61, "log_gamma": 61, "has_converg": 61, "update_log_gamma_beta_unclip": 61, "log_gamma0": 61, "update_log_gamma_unclip": 61, "plot": 62, "add_colorbar": 62, "fig": 62, "ax": 62, "im": 62, "colorbar": 62, "mpl_toolkit": 62, "axes_grid1": 62, "axes_divid": 62, "make_axes_locat": 62, "cb": 62, "matplotlib": 62, "add_inner_rect": 62, "slice_0": 62, "slice_1": 62, "thick": 62, "color": 62, "rectangular": 62, "frame": 62, "surround": 62, "outsid": 62, "hide": 62, "add_inset": 62, "axes_rect": 62, "rect": 62, "cmap": 62, "grai": 62, "vmin": 62, "vmax": 62, "interpol": 62, "frame_color": 62, "aa0000": 62, "frame_path": 62, "clip_path_clos": 62, "mark_in_orig": 62, "upper": 62, "inset": 62, "axin": 62, "add_log_lik": 62, "log_lik": 62, "as_xlabel": 62, "po": 62, "add_metr": 62, "ssim": [62, 65], "configure_matplotlib": 62, "common": 62, "hex_to_rgb": 62, "alpha": 62, "convert": 62, "hex": 62, "plot_hist": 62, "label_list": 62, "titl": 62, "xlim": 62, "ylim": 62, "yscale": 62, "remove_tick": 62, "color_list": 62, "alpha_list": 62, "hist_kwarg": 62, "hist_kwargs_per_data": 62, "legend_kwarg": 62, "histogram": 62, "n_list": 62, "pyplot": 62, "hist": 62, "bins_list": 62, "bin": 62, "plot_imag": 62, "insets_mark_in_orig": 62, "axesimag": 62, "imshow": 62, "plot_qq": 62, "zorder_list": 62, "quantil": 62, "get_random_ellipses_imag": 63, "num_imag": 63, "batch_tv_grad": 64, "tv_loss": 64, "4d": 64, "anisotrop": 64, "horizont": 64, "vertic": 64, "want": 64, "customautogradfunct": 65, "customautogradmodul": 65, "data_rang": 65, "peak": 65, "signal": 65, "ratio": 65, "wang": 65, "bovik": 65, "sheikh": 65, "simoncelli": 65, "2004": 65, "qualiti": 65, "assess": 65, "error": 65, "visibl": 65, "transact": 65, "tip": 65, "2003": 65, "819861": 65, "assert_positive_diag": 65, "strictli": 65, "bisect_left": 65, "lo": 65, "hi": 65, "sort": 65, "appear": 65, "leftmost": 65, "len": 65, "bound": 65, "search": [65, 66], "python": 65, "bisect": 65, "precon_closur": 65, "max_nit": 65, "eval_mod": 65, "manag": 65, "enter": 65, "reset": 65, "exit": 65, "get_modules_by_nam": 65, "layer_nam": 65, "get_original_cwd": 65, "get_params_from_nn_modul": 65, "exclude_norm_lay": 65, "exclude_bia": 65, "bia": 65, "list_norm_layer_param": 65, "groupnorm": 65, "batchnorm2d": 65, "instancenorm2d": 65, "make_cholesk": 65, "max_nstep": 65, "1000": 65, "make": 65, "decompos": 65, "small": 65, "modifi": 65, "try": 65, "limit": 65, "anyth": 65, "chol": 65, "successfulli": 65, "packag": 66, "subpackag": 66, "modul": 66, "page": 66}, "objects": {"": [[0, 0, 0, "-", "baselines"], [3, 0, 0, "-", "bayes_dip"]], "baselines": [[1, 0, 0, "-", "evaluation_utils"], [2, 0, 0, "-", "mcdo_dip_utils"]], "baselines.evaluation_utils": [[1, 1, 1, "", "compute_mcdo_reconstruction"], [1, 1, 1, "", "get_mcdo_density_data"], [1, 1, 1, "", "get_mcdo_stddev"]], "baselines.mcdo_dip_utils": [[2, 1, 1, "", "approx_kernel_density"], [2, 1, 1, "", "bayesianize_unet_architecture"], [2, 2, 1, "", "conv2d_dropout"], [2, 2, 1, "", "mc_dropout2d"], [2, 1, 1, "", "sample_from_bayesianized_model"]], "baselines.mcdo_dip_utils.conv2d_dropout": [[2, 3, 1, "", "__init__"], [2, 3, 1, "", "forward"]], "baselines.mcdo_dip_utils.mc_dropout2d": [[2, 3, 1, "", "forward"]], "bayes_dip": [[4, 0, 0, "-", "data"], [17, 0, 0, "-", "dip"], [21, 0, 0, "-", "inference"], [26, 0, 0, "-", "marginal_likelihood_optim"], [35, 0, 0, "-", "probabilistic_models"], [57, 0, 0, "-", "utils"]], "bayes_dip.data": [[5, 0, 0, "-", "datasets"], [9, 0, 0, "-", "simulation"], [10, 0, 0, "-", "trafo"], [15, 0, 0, "-", "utils"], [16, 0, 0, "-", "walnut_utils"]], "bayes_dip.data.datasets": [[6, 0, 0, "-", "mnist"], [7, 0, 0, "-", "rectangles"], [8, 0, 0, "-", "walnut"]], "bayes_dip.data.datasets.mnist": [[6, 2, 1, "", "MNISTImageDataset"], [6, 1, 1, "", "get_kmnist_testset"], [6, 1, 1, "", "get_kmnist_trainset"], [6, 1, 1, "", "get_mnist_testset"], [6, 1, 1, "", "get_mnist_trainset"]], "bayes_dip.data.datasets.mnist.MNISTImageDataset": [[6, 3, 1, "", "__init__"]], "bayes_dip.data.datasets.rectangles": [[7, 2, 1, "", "RectanglesDataset"]], "bayes_dip.data.datasets.rectangles.RectanglesDataset": [[7, 3, 1, "", "__init__"]], "bayes_dip.data.datasets.walnut": [[8, 1, 1, "", "get_walnut_2d_ground_truth"], [8, 1, 1, "", "get_walnut_2d_inner_part_defined_by_patch_size"], [8, 1, 1, "", "get_walnut_2d_inner_patch_indices"], [8, 1, 1, "", "get_walnut_2d_observation"]], "bayes_dip.data.simulation": [[9, 2, 1, "", "SimulatedDataset"], [9, 1, 1, "", "simulate"]], "bayes_dip.data.simulation.SimulatedDataset": [[9, 3, 1, "", "__init__"]], "bayes_dip.data.trafo": [[11, 0, 0, "-", "base_ray_trafo"], [12, 0, 0, "-", "matmul_ray_trafo"], [13, 0, 0, "-", "parallel_beam_2d_ray_trafo"], [14, 0, 0, "-", "walnut_2d_ray_trafo"]], "bayes_dip.data.trafo.base_ray_trafo": [[11, 2, 1, "", "BaseRayTrafo"]], "bayes_dip.data.trafo.base_ray_trafo.BaseRayTrafo": [[11, 3, 1, "", "__init__"], [11, 4, 1, "", "angles"], [11, 3, 1, "", "fbp"], [11, 3, 1, "", "forward"], [11, 3, 1, "", "trafo"], [11, 3, 1, "", "trafo_adjoint"], [11, 3, 1, "", "trafo_adjoint_flat"], [11, 3, 1, "", "trafo_flat"]], "bayes_dip.data.trafo.matmul_ray_trafo": [[12, 2, 1, "", "MatmulRayTrafo"]], "bayes_dip.data.trafo.matmul_ray_trafo.MatmulRayTrafo": [[12, 3, 1, "", "__init__"], [12, 4, 1, "", "angles"], [12, 3, 1, "", "fbp"], [12, 3, 1, "", "trafo"], [12, 3, 1, "", "trafo_adjoint"], [12, 3, 1, "", "trafo_adjoint_flat"], [12, 3, 1, "", "trafo_flat"]], "bayes_dip.data.trafo.parallel_beam_2d_ray_trafo": [[13, 2, 1, "", "ParallelBeam2DRayTrafo"], [13, 1, 1, "", "get_odl_ray_trafo_parallel_beam_2d"], [13, 1, 1, "", "get_odl_ray_trafo_parallel_beam_2d_matrix"], [13, 1, 1, "", "get_parallel_beam_2d_matmul_ray_trafo"]], "bayes_dip.data.trafo.parallel_beam_2d_ray_trafo.ParallelBeam2DRayTrafo": [[13, 3, 1, "", "__init__"], [13, 4, 1, "", "angles"], [13, 3, 1, "", "fbp"], [13, 3, 1, "", "trafo"], [13, 3, 1, "", "trafo_adjoint"], [13, 3, 1, "", "trafo_adjoint_flat"], [13, 3, 1, "", "trafo_flat"]], "bayes_dip.data.trafo.walnut_2d_ray_trafo": [[14, 1, 1, "", "get_walnut_2d_ray_trafo"]], "bayes_dip.data.utils": [[15, 1, 1, "", "get_ray_trafo"]], "bayes_dip.data.walnut_utils": [[16, 2, 1, "", "MaskedWalnutRayTrafo"], [16, 2, 1, "", "NumpyFunction"], [16, 2, 1, "", "WalnutRayTrafo"], [16, 2, 1, "", "WalnutRayTrafoModule"], [16, 1, 1, "", "astra_bp3d_cuda"], [16, 1, 1, "", "astra_fdk_cuda"], [16, 1, 1, "", "astra_fp3d_cuda"], [16, 1, 1, "", "down_sample_vol"], [16, 1, 1, "", "get_down_sampled_vol_shape"], [16, 1, 1, "", "get_first_proj_col_for_sub_sampling"], [16, 1, 1, "", "get_first_proj_row_for_sub_sampling"], [16, 1, 1, "", "get_ground_truth"], [16, 1, 1, "", "get_ground_truth_3d"], [16, 1, 1, "", "get_masked_ray_trafo_matrix"], [16, 1, 1, "", "get_proj_geom"], [16, 1, 1, "", "get_projection_data"], [16, 1, 1, "", "get_single_slice_ind"], [16, 1, 1, "", "get_single_slice_ray_trafo"], [16, 1, 1, "", "get_single_slice_ray_trafo_matrix"], [16, 1, 1, "", "get_single_slice_ray_trafo_matrix_filename"], [16, 1, 1, "", "get_vol_geom"], [16, 1, 1, "", "save_masked_ray_trafo_matrix"], [16, 1, 1, "", "save_single_slice_ray_trafo_matrix"], [16, 1, 1, "", "sub_sample_proj"], [16, 1, 1, "", "up_sample_proj"]], "bayes_dip.data.walnut_utils.MaskedWalnutRayTrafo": [[16, 3, 1, "", "__init__"], [16, 3, 1, "", "apply"], [16, 3, 1, "", "apply_adjoint"], [16, 3, 1, "", "apply_fdk"], [16, 3, 1, "", "assert_proj_rows_suffice"], [16, 3, 1, "", "assert_vol_slices_suffice"], [16, 3, 1, "", "bp3d"], [16, 3, 1, "", "build_proj_mask"], [16, 3, 1, "", "fdk"], [16, 3, 1, "", "flat_projs_in_mask"], [16, 3, 1, "", "fp3d"], [16, 3, 1, "", "get_inds_in_flat_projs_per_angle"], [16, 3, 1, "", "get_proj_slice_contributing_to_masked_vol"], [16, 3, 1, "", "get_vol_slice_contributing_to_masked_projs"], [16, 3, 1, "", "projs_from_flat_projs_in_mask"], [16, 3, 1, "", "projs_from_full"], [16, 3, 1, "", "vol_from_full"], [16, 3, 1, "", "vol_from_vol_in_mask"], [16, 3, 1, "", "vol_in_mask"]], "bayes_dip.data.walnut_utils.NumpyFunction": [[16, 3, 1, "", "backward"], [16, 3, 1, "", "forward"]], "bayes_dip.data.walnut_utils.WalnutRayTrafo": [[16, 3, 1, "", "__init__"], [16, 3, 1, "", "apply"], [16, 3, 1, "", "apply_adjoint"], [16, 3, 1, "", "apply_fdk"], [16, 3, 1, "", "bp3d"], [16, 3, 1, "", "fdk"], [16, 3, 1, "", "fp3d"]], "bayes_dip.data.walnut_utils.WalnutRayTrafoModule": [[16, 3, 1, "", "__init__"], [16, 3, 1, "", "forward"]], "bayes_dip.dip": [[18, 0, 0, "-", "deep_image_prior"], [19, 0, 0, "-", "network"]], "bayes_dip.dip.deep_image_prior": [[18, 2, 1, "", "DeepImagePriorReconstructor"]], "bayes_dip.dip.deep_image_prior.DeepImagePriorReconstructor": [[18, 3, 1, "", "__init__"], [18, 3, 1, "", "init_nn_model"], [18, 3, 1, "", "load_params"], [18, 3, 1, "", "reconstruct"]], "bayes_dip.dip.network": [[20, 0, 0, "-", "unet"]], "bayes_dip.dip.network.unet": [[20, 2, 1, "", "Concat"], [20, 2, 1, "", "DownBlock"], [20, 2, 1, "", "InBlock"], [20, 2, 1, "", "OutBlock"], [20, 2, 1, "", "UNet"], [20, 2, 1, "", "UNetReturnPreSigmoid"], [20, 2, 1, "", "UpBlock"]], "bayes_dip.dip.network.unet.Concat": [[20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.DownBlock": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.InBlock": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.OutBlock": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.UNet": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.UNetReturnPreSigmoid": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.dip.network.unet.UpBlock": [[20, 3, 1, "", "__init__"], [20, 3, 1, "", "forward"]], "bayes_dip.inference": [[22, 0, 0, "-", "base_predictive_posterior"], [23, 0, 0, "-", "exact_predictive_posterior"], [24, 0, 0, "-", "sample_based_predictive_posterior"], [25, 0, 0, "-", "utils"]], "bayes_dip.inference.base_predictive_posterior": [[22, 2, 1, "", "BasePredictivePosterior"]], "bayes_dip.inference.base_predictive_posterior.BasePredictivePosterior": [[22, 3, 1, "", "__init__"], [22, 3, 1, "", "covariance"], [22, 3, 1, "", "log_prob"], [22, 3, 1, "", "sample"]], "bayes_dip.inference.exact_predictive_posterior": [[23, 2, 1, "", "ExactPredictivePosterior"]], "bayes_dip.inference.exact_predictive_posterior.ExactPredictivePosterior": [[23, 3, 1, "", "__init__"], [23, 3, 1, "", "covariance"], [23, 3, 1, "", "log_prob"], [23, 3, 1, "", "multivariate_normal_distribution"], [23, 3, 1, "", "sample"]], "bayes_dip.inference.sample_based_predictive_posterior": [[24, 2, 1, "", "SampleBasedPredictivePosterior"], [24, 1, 1, "", "approx_predictive_cov_image_patch_from_zero_mean_samples_batched"], [24, 1, 1, "", "log_prob_patches"], [24, 1, 1, "", "predictive_cov_image_patch_log_prob_unscaled_batched"], [24, 1, 1, "", "predictive_cov_image_patch_norm"], [24, 1, 1, "", "yield_covariances_patches"]], "bayes_dip.inference.sample_based_predictive_posterior.SampleBasedPredictivePosterior": [[24, 3, 1, "", "log_prob"], [24, 3, 1, "", "log_prob_patches"], [24, 3, 1, "", "sample_zero_mean"], [24, 3, 1, "", "yield_covariances_patches"]], "bayes_dip.inference.utils": [[25, 1, 1, "", "get_image_patch_mask_inds"], [25, 1, 1, "", "get_image_patch_slices"], [25, 1, 1, "", "is_invalid"], [25, 1, 1, "", "yield_padded_batched_images_patches"]], "bayes_dip.marginal_likelihood_optim": [[27, 0, 0, "-", "mll_optim"], [28, 0, 0, "-", "observation_cov_log_det_grad"], [29, 0, 0, "-", "preconditioner"], [30, 0, 0, "-", "preconditioner_utils"], [31, 0, 0, "-", "random_probes"], [32, 0, 0, "-", "sample_based_predcp"], [33, 0, 0, "-", "utils"], [34, 0, 0, "-", "weights_linearization"]], "bayes_dip.marginal_likelihood_optim.mll_optim": [[27, 1, 1, "", "marginal_likelihood_hyperparams_optim"]], "bayes_dip.marginal_likelihood_optim.observation_cov_log_det_grad": [[28, 1, 1, "", "approx_observation_cov_log_det_grads"]], "bayes_dip.marginal_likelihood_optim.preconditioner": [[29, 2, 1, "", "BasePreconditioner"], [29, 2, 1, "", "IncompleteCholeskyPreconditioner"], [29, 2, 1, "", "JacobiPreconditioner"], [29, 2, 1, "", "LowRankObservationCovPreconditioner"], [29, 1, 1, "", "get_preconditioner"]], "bayes_dip.marginal_likelihood_optim.preconditioner.BasePreconditioner": [[29, 3, 1, "", "__init__"], [29, 3, 1, "", "get_closure"], [29, 3, 1, "", "matmul"], [29, 3, 1, "", "sample"], [29, 3, 1, "", "update"]], "bayes_dip.marginal_likelihood_optim.preconditioner.IncompleteCholeskyPreconditioner": [[29, 3, 1, "", "__init__"], [29, 3, 1, "", "get_closure"], [29, 3, 1, "", "matmul"], [29, 3, 1, "", "sample"], [29, 3, 1, "", "update"]], "bayes_dip.marginal_likelihood_optim.preconditioner.JacobiPreconditioner": [[29, 3, 1, "", "__init__"], [29, 3, 1, "", "get_closure"], [29, 3, 1, "", "matmul"], [29, 3, 1, "", "sample"], [29, 3, 1, "", "update"]], "bayes_dip.marginal_likelihood_optim.preconditioner.LowRankObservationCovPreconditioner": [[29, 3, 1, "", "__init__"], [29, 3, 1, "", "matmul"], [29, 3, 1, "", "sample"], [29, 3, 1, "", "update"]], "bayes_dip.marginal_likelihood_optim.preconditioner_utils": [[30, 1, 1, "", "approx_diag"], [30, 1, 1, "", "pivoted_cholesky"]], "bayes_dip.marginal_likelihood_optim.random_probes": [[31, 1, 1, "", "generate_probes_bernoulli"]], "bayes_dip.marginal_likelihood_optim.sample_based_predcp": [[32, 1, 1, "", "sample_based_predcp_grads"]], "bayes_dip.marginal_likelihood_optim.utils": [[33, 1, 1, "", "get_ordered_nn_params_vec"]], "bayes_dip.marginal_likelihood_optim.weights_linearization": [[34, 1, 1, "", "weights_linearization"]], "bayes_dip.probabilistic_models": [[36, 0, 0, "-", "base_image_cov"], [37, 0, 0, "-", "base_observation_cov"], [38, 0, 0, "-", "image_noise_correction"], [39, 0, 0, "-", "isotropic"], [40, 0, 0, "-", "linear_sandwich_cov"], [41, 0, 0, "-", "linearized_dip"], [56, 0, 0, "-", "observation_cov"]], "bayes_dip.probabilistic_models.base_image_cov": [[36, 2, 1, "", "BaseImageCov"]], "bayes_dip.probabilistic_models.base_image_cov.BaseImageCov": [[36, 3, 1, "", "forward"], [36, 3, 1, "", "sample"], [36, 4, 1, "", "shape"]], "bayes_dip.probabilistic_models.base_observation_cov": [[37, 2, 1, "", "BaseObservationCov"]], "bayes_dip.probabilistic_models.base_observation_cov.BaseObservationCov": [[37, 3, 1, "", "__init__"], [37, 3, 1, "", "forward"], [37, 3, 1, "", "get_closure"], [37, 4, 1, "", "shape"]], "bayes_dip.probabilistic_models.image_noise_correction": [[38, 1, 1, "", "get_image_noise_correction_term"], [38, 1, 1, "", "get_trafo_t_trafo_pseudo_inv_diag_mean"]], "bayes_dip.probabilistic_models.linear_sandwich_cov": [[40, 2, 1, "", "LinearSandwichCov"]], "bayes_dip.probabilistic_models.linear_sandwich_cov.LinearSandwichCov": [[40, 3, 1, "", "__init__"], [40, 3, 1, "", "forward"], [40, 3, 1, "", "lin_op"], [40, 3, 1, "", "lin_op_transposed"]], "bayes_dip.probabilistic_models.linearized_dip": [[42, 0, 0, "-", "default_unet_priors"], [43, 0, 0, "-", "image_cov"], [44, 0, 0, "-", "low_rank_observation_cov"], [45, 0, 0, "-", "neural_basis_expansion"], [52, 0, 0, "-", "parameter_cov"], [53, 0, 0, "-", "parameter_priors"], [55, 0, 0, "-", "utils"]], "bayes_dip.probabilistic_models.linearized_dip.default_unet_priors": [[42, 1, 1, "", "get_default_unet_gaussian_prior_dicts"], [42, 1, 1, "", "get_default_unet_gprior_dicts"]], "bayes_dip.probabilistic_models.linearized_dip.image_cov": [[43, 2, 1, "", "ImageCov"]], "bayes_dip.probabilistic_models.linearized_dip.image_cov.ImageCov": [[43, 3, 1, "", "__init__"], [43, 3, 1, "", "forward"], [43, 3, 1, "", "lin_op"], [43, 3, 1, "", "lin_op_transposed"], [43, 3, 1, "", "sample"], [43, 4, 1, "", "shape"]], "bayes_dip.probabilistic_models.linearized_dip.low_rank_observation_cov": [[44, 2, 1, "", "LowRankObservationCov"]], "bayes_dip.probabilistic_models.linearized_dip.low_rank_observation_cov.LowRankObservationCov": [[44, 3, 1, "", "__init__"], [44, 3, 1, "", "forward"], [44, 3, 1, "", "get_low_rank_observation_cov_basis"], [44, 3, 1, "", "load_approx_basis"], [44, 3, 1, "", "matmul"], [44, 3, 1, "", "sample"], [44, 3, 1, "", "save_approx_basis"], [44, 3, 1, "", "update"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion": [[46, 0, 0, "-", "base_neural_basis_expansion"], [47, 0, 0, "-", "functorch_utils"], [48, 0, 0, "-", "getter"], [49, 0, 0, "-", "gprior_neural_basis_expansion"], [50, 0, 0, "-", "low_rank_neural_basis_expansion"], [51, 0, 0, "-", "neural_basis_expansion"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion": [[46, 2, 1, "", "BaseMatmulNeuralBasisExpansion"], [46, 2, 1, "", "BaseNeuralBasisExpansion"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion.BaseMatmulNeuralBasisExpansion": [[46, 3, 1, "", "get_matrix"], [46, 3, 1, "", "jvp"], [46, 4, 1, "", "matrix"], [46, 3, 1, "", "update_matrix"], [46, 3, 1, "", "vjp"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.base_neural_basis_expansion.BaseNeuralBasisExpansion": [[46, 3, 1, "", "__init__"], [46, 4, 1, "", "jac_shape"], [46, 3, 1, "", "jvp"], [46, 3, 1, "", "vjp"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.functorch_utils": [[47, 1, 1, "", "flatten_grad_functorch"], [47, 1, 1, "", "unflatten_nn_functorch"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.getter": [[48, 1, 1, "", "get_matmul_neural_basis_expansion"], [48, 1, 1, "", "get_neural_basis_expansion"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion": [[49, 2, 1, "", "GpriorNeuralBasisExpansion"], [49, 2, 1, "", "MatmulGpriorNeuralBasisExpansion"], [49, 2, 1, "", "MixinGpriorNeuralBasisExpansion"], [49, 1, 1, "", "compute_scale"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion.GpriorNeuralBasisExpansion": [[49, 3, 1, "", "__init__"], [49, 3, 1, "", "compute_scale"], [49, 3, 1, "", "jvp"], [49, 4, 1, "", "scale"], [49, 3, 1, "", "update_scale"], [49, 3, 1, "", "vjp"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion.MatmulGpriorNeuralBasisExpansion": [[49, 3, 1, "", "__init__"], [49, 3, 1, "", "compute_scale"], [49, 3, 1, "", "get_matrix"], [49, 4, 1, "", "matrix"], [49, 4, 1, "", "scale"], [49, 3, 1, "", "update"], [49, 3, 1, "", "update_matrix"], [49, 3, 1, "", "update_scale"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.gprior_neural_basis_expansion.MixinGpriorNeuralBasisExpansion": [[49, 3, 1, "", "compute_scale"], [49, 4, 1, "", "scale"], [49, 3, 1, "", "update_scale"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.low_rank_neural_basis_expansion": [[50, 2, 1, "", "LowRankNeuralBasisExpansion"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.low_rank_neural_basis_expansion.LowRankNeuralBasisExpansion": [[50, 3, 1, "", "__init__"], [50, 3, 1, "", "get_low_rank_jac_basis"], [50, 3, 1, "", "jvp"], [50, 3, 1, "", "load"], [50, 3, 1, "", "save"], [50, 3, 1, "", "vjp"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion": [[51, 2, 1, "", "MatmulNeuralBasisExpansion"], [51, 2, 1, "", "NeuralBasisExpansion"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion.MatmulNeuralBasisExpansion": [[51, 3, 1, "", "__init__"], [51, 3, 1, "", "get_matrix"], [51, 4, 1, "", "matrix"], [51, 3, 1, "", "update_matrix"]], "bayes_dip.probabilistic_models.linearized_dip.neural_basis_expansion.neural_basis_expansion.NeuralBasisExpansion": [[51, 3, 1, "", "__init__"], [51, 3, 1, "", "jvp"], [51, 3, 1, "", "vjp"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_cov": [[52, 2, 1, "", "ParameterCov"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_cov.ParameterCov": [[52, 3, 1, "", "__init__"], [52, 3, 1, "", "forward"], [52, 4, 1, "", "log_variances"], [52, 4, 1, "", "ordered_nn_params"], [52, 3, 1, "", "sample"], [52, 4, 1, "", "shape"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors": [[54, 0, 0, "-", "priors"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors": [[54, 2, 1, "", "BaseGaussPrior"], [54, 2, 1, "", "GPprior"], [54, 2, 1, "", "IsotropicPrior"], [54, 2, 1, "", "NormalPrior"], [54, 2, 1, "", "RadialBasisFuncCov"], [54, 1, 1, "", "get_GPprior_RadialBasisFuncCov"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.BaseGaussPrior": [[54, 3, 1, "", "__init__"], [54, 3, 1, "", "batched_cov_mul"], [54, 3, 1, "", "cov_log_det"], [54, 3, 1, "", "cov_mat"], [54, 3, 1, "", "get_params_under_prior"], [54, 3, 1, "", "get_params_under_prior_from_modules"], [54, 3, 1, "", "log_prob"], [54, 4, 1, "", "log_variance"], [54, 3, 1, "", "sample"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.GPprior": [[54, 3, 1, "", "__init__"], [54, 3, 1, "", "cov_log_det"], [54, 3, 1, "", "cov_log_lengthscale_grad"], [54, 3, 1, "", "cov_log_variance_grad"], [54, 3, 1, "", "cov_mat"], [54, 4, 1, "", "log_lengthscale"], [54, 3, 1, "", "log_prob"], [54, 4, 1, "", "log_variance"], [54, 3, 1, "", "sample"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.IsotropicPrior": [[54, 3, 1, "", "batched_cov_mul"], [54, 3, 1, "", "cov_log_det"], [54, 3, 1, "", "cov_mat"], [54, 3, 1, "", "log_prob"], [54, 4, 1, "", "log_variance"], [54, 3, 1, "", "sample"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.NormalPrior": [[54, 3, 1, "", "cov_log_det"], [54, 3, 1, "", "cov_mat"], [54, 3, 1, "", "log_prob"], [54, 4, 1, "", "log_variance"], [54, 3, 1, "", "sample"]], "bayes_dip.probabilistic_models.linearized_dip.parameter_priors.priors.RadialBasisFuncCov": [[54, 3, 1, "", "__init__"], [54, 3, 1, "", "cov_mat"], [54, 3, 1, "", "init_parameters"], [54, 3, 1, "", "log_det"], [54, 3, 1, "", "log_lengthscale_cov_mat_grad"], [54, 3, 1, "", "log_variance_cov_mat_grad"], [54, 3, 1, "", "unscaled_cov_mat"]], "bayes_dip.probabilistic_models.linearized_dip.utils": [[55, 1, 1, "", "get_inds_from_ordered_params"], [55, 1, 1, "", "get_slices_from_ordered_params"]], "bayes_dip.probabilistic_models.observation_cov": [[56, 2, 1, "", "MatmulObservationCov"], [56, 2, 1, "", "ObservationCov"]], "bayes_dip.probabilistic_models.observation_cov.MatmulObservationCov": [[56, 3, 1, "", "__init__"], [56, 3, 1, "", "forward"], [56, 3, 1, "", "get_matrix"]], "bayes_dip.probabilistic_models.observation_cov.ObservationCov": [[56, 3, 1, "", "assemble_observation_cov"], [56, 3, 1, "", "forward"], [56, 3, 1, "", "get_stabilizing_eps"]], "bayes_dip.utils": [[58, 0, 0, "-", "evaluation_utils"], [59, 0, 0, "-", "experiment_utils"], [60, 0, 0, "-", "linear_cg_gpytorch"], [61, 0, 0, "-", "linear_cg_gpytorch_log_cg_re"], [62, 0, 0, "-", "plot_utils"], [63, 0, 0, "-", "test_utils"], [64, 0, 0, "-", "tv"], [65, 0, 0, "-", "utils"]], "bayes_dip.utils.evaluation_utils": [[58, 1, 1, "", "compute_log_prob_for_patch_size_from_cov"], [58, 1, 1, "", "extract_tensorboard_scalars"], [58, 1, 1, "", "find_single_log_file"], [58, 1, 1, "", "get_abs_diff"], [58, 1, 1, "", "get_density_data"], [58, 1, 1, "", "get_ground_truth"], [58, 1, 1, "", "get_image_cov"], [58, 1, 1, "", "get_nn_model"], [58, 1, 1, "", "get_observation"], [58, 1, 1, "", "get_patch_idx_to_mask_inds_dict"], [58, 1, 1, "", "get_recon"], [58, 1, 1, "", "get_sample_based_cov_diag"], [58, 1, 1, "", "get_stddev"], [58, 1, 1, "", "is_single_level_date_time_path"], [58, 1, 1, "", "recompute_reconstruction"], [58, 1, 1, "", "restrict_sample_based_density_data_to_new_patch_idx_list"], [58, 1, 1, "", "translate_multirun_path"], [58, 1, 1, "", "translate_output_path"], [58, 1, 1, "", "translate_path"]], "bayes_dip.utils.experiment_utils": [[59, 1, 1, "", "assert_sample_matches"], [59, 1, 1, "", "get_predefined_patch_idx_list"], [59, 1, 1, "", "get_standard_dataset"], [59, 1, 1, "", "get_standard_ray_trafo"], [59, 1, 1, "", "load_samples"], [59, 1, 1, "", "save_samples"]], "bayes_dip.utils.linear_cg_gpytorch": [[60, 1, 1, "", "linear_cg"]], "bayes_dip.utils.linear_cg_gpytorch_log_cg_re": [[61, 1, 1, "", "compute_robust_denom_unclipped"], [61, 1, 1, "", "cond_fun"], [61, 1, 1, "", "initialize_log_re"], [61, 1, 1, "", "linear_log_cg_re"], [61, 1, 1, "", "logsumexp"], [61, 1, 1, "", "re_orthogonalization"], [61, 1, 1, "", "take_cg_step_log_re"], [61, 1, 1, "", "update_alpha_log_unclipped"], [61, 1, 1, "", "update_log_gamma_beta_unclipped"], [61, 1, 1, "", "update_log_gamma_unclipped"]], "bayes_dip.utils.plot_utils": [[62, 1, 1, "", "add_colorbar"], [62, 1, 1, "", "add_inner_rect"], [62, 1, 1, "", "add_inset"], [62, 1, 1, "", "add_log_lik"], [62, 1, 1, "", "add_metrics"], [62, 1, 1, "", "configure_matplotlib"], [62, 1, 1, "", "hex_to_rgb"], [62, 1, 1, "", "plot_hist"], [62, 1, 1, "", "plot_image"], [62, 1, 1, "", "plot_qq"]], "bayes_dip.utils.test_utils": [[63, 1, 1, "", "get_random_ellipses_images"]], "bayes_dip.utils.tv": [[64, 1, 1, "", "batch_tv_grad"], [64, 1, 1, "", "tv_loss"]], "bayes_dip.utils.utils": [[65, 2, 1, "", "CustomAutogradFunction"], [65, 2, 1, "", "CustomAutogradModule"], [65, 1, 1, "", "PSNR"], [65, 1, 1, "", "SSIM"], [65, 1, 1, "", "assert_positive_diag"], [65, 1, 1, "", "bisect_left"], [65, 1, 1, "", "cg"], [65, 2, 1, "", "eval_mode"], [65, 1, 1, "", "get_modules_by_names"], [65, 1, 1, "", "get_original_cwd"], [65, 1, 1, "", "get_params_from_nn_module"], [65, 1, 1, "", "list_norm_layer_params"], [65, 1, 1, "", "make_choleskable"], [65, 1, 1, "", "normalize"]], "bayes_dip.utils.utils.CustomAutogradFunction": [[65, 3, 1, "", "backward"], [65, 3, 1, "", "forward"]], "bayes_dip.utils.utils.CustomAutogradModule": [[65, 3, 1, "", "__init__"], [65, 3, 1, "", "forward"]], "bayes_dip.utils.utils.eval_mode": [[65, 3, 1, "", "__init__"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"]}, "titleterms": {"baselin": [0, 1, 2], "packag": [0, 3, 4, 5, 10, 17, 19, 21, 26, 35, 39, 41, 45, 53, 57], "submodul": [0, 4, 5, 10, 17, 19, 21, 26, 35, 41, 45, 53, 57], "modul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65], "content": [0, 3, 4, 5, 10, 17, 19, 21, 26, 35, 39, 41, 45, 53, 57, 66], "evaluation_util": [1, 58], "mcdo_dip_util": 2, "bayes_dip": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65], "subpackag": [3, 4, 17, 35, 41], "data": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "dataset": [5, 6, 7, 8], "mnist": 6, "rectangl": 7, "walnut": 8, "simul": 9, "trafo": [10, 11, 12, 13, 14], "base_ray_trafo": 11, "matmul_ray_trafo": 12, "parallel_beam_2d_ray_trafo": 13, "walnut_2d_ray_trafo": 14, "util": [15, 25, 33, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65], "walnut_util": 16, "dip": [17, 18, 19, 20, 66], "deep_image_prior": 18, "network": [19, 20], "unet": 20, "infer": [21, 22, 23, 24, 25], "base_predictive_posterior": 22, "exact_predictive_posterior": 23, "sample_based_predictive_posterior": 24, "marginal_likelihood_optim": [26, 27, 28, 29, 30, 31, 32, 33, 34], "mll_optim": 27, "observation_cov_log_det_grad": 28, "precondition": 29, "preconditioner_util": 30, "random_prob": 31, "sample_based_predcp": 32, "weights_linear": 34, "probabilistic_model": [35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56], "base_image_cov": 36, "base_observation_cov": 37, "image_noise_correct": 38, "isotrop": 39, "linear_sandwich_cov": 40, "linearized_dip": [41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55], "default_unet_prior": 42, "image_cov": 43, "low_rank_observation_cov": 44, "neural_basis_expans": [45, 46, 47, 48, 49, 50, 51], "base_neural_basis_expans": 46, "functorch_util": 47, "getter": 48, "gprior_neural_basis_expans": 49, "low_rank_neural_basis_expans": 50, "parameter_cov": 52, "parameter_prior": [53, 54], "prior": 54, "observation_cov": 56, "experiment_util": 59, "linear_cg_gpytorch": 60, "linear_cg_gpytorch_log_cg_r": 61, "plot_util": 62, "test_util": 63, "tv": 64, "welcom": 66, "bay": 66, "s": 66, "document": 66, "indic": 66, "tabl": 66}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})